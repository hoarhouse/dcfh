<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supply Chain Carbon Hotspot Mapper - PROMETHEUS</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --cyan: #00D4FF;
            --teal: #00B4D8;
            --dark-bg: #0A0E1A;
            --dark-card: #0F1420;
            --dark-border: #1a2332;
            --green: #10a37f;
            --amber: #ff9500;
            --red: #dc2626;
            --gray: #6b7280;
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --bg-gray: #f5f5f7;
            --border: #d2d2d7;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            line-height: 1.47059;
            letter-spacing: -0.022em;
            background: linear-gradient(135deg, var(--dark-bg) 0%, var(--dark-card) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
        }

        /* Navigation */
        nav {
            background: rgba(15, 20, 32, 0.98);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--dark-border);
            padding: 0 max(22px, env(safe-area-inset-left));
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-content {
            max-width: 1200px;
            margin: 0 auto;
            height: 52px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            font-size: 21px;
            font-weight: 600;
            color: var(--text-primary);
            text-decoration: none;
        }

        .breadcrumb {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .breadcrumb a {
            color: var(--cyan);
            text-decoration: none;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 60px 22px;
        }

        /* Cross-Links Section */
        .cross-links {
            background: linear-gradient(135deg, var(--dark-bg) 0%, #0F1420 100%);
            padding: 80px 22px;
            margin-top: 80px;
        }

        .cross-links-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .cross-links-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .cross-links-title {
            font-size: 32px;
            font-weight: 600;
            color: white;
            margin-bottom: 16px;
        }

        .cross-links-subtitle {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.7);
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        .tool-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 30px;
            text-decoration: none;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .tool-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--cyan), var(--teal));
            transform: scaleX(0);
            transition: transform 0.3s;
        }

        .tool-card:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: var(--cyan);
            transform: translateY(-3px);
        }

        .tool-card:hover::before {
            transform: scaleX(1);
        }

        .tool-icon {
            font-size: 36px;
            margin-bottom: 16px;
            display: block;
        }

        .tool-name {
            font-size: 20px;
            font-weight: 600;
            color: white;
            margin-bottom: 8px;
        }

        .tool-desc {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            line-height: 1.5;
        }

        .back-to-hub {
            text-align: center;
            margin-top: 40px;
        }

        .hub-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--cyan);
            text-decoration: none;
            font-size: 16px;
            transition: all 0.3s;
        }

        .hub-link:hover {
            gap: 12px;
        }

        /* Welcome Screen */
        .welcome-screen {
            text-align: center;
            padding: 60px 0;
        }

        .badge {
            display: inline-block;
            padding: 8px 16px;
            background: rgba(0, 212, 255, 0.2);
            border: 1px solid var(--cyan);
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 30px;
            color: var(--cyan);
            letter-spacing: 0.5px;
        }

        h1 {
            font-size: 56px;
            line-height: 1.1;
            font-weight: 600;
            margin-bottom: 20px;
            background: linear-gradient(135deg, var(--cyan) 0%, var(--teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subhead {
            font-size: 24px;
            color: var(--text-secondary);
            margin-bottom: 40px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .context {
            font-size: 17px;
            line-height: 1.7;
            color: var(--text-secondary);
            margin-bottom: 40px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .learn-list {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 30px;
            margin: 40px auto;
            max-width: 600px;
            text-align: left;
            border: 1px solid var(--dark-border);
        }

        .learn-list h3 {
            font-size: 18px;
            margin-bottom: 20px;
            color: var(--cyan);
        }

        .learn-list ul {
            list-style: none;
        }

        .learn-list li {
            padding: 10px 0;
            padding-left: 30px;
            position: relative;
            color: var(--text-secondary);
        }

        .learn-list li::before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: var(--cyan);
            font-weight: bold;
        }

        .start-button {
            background: linear-gradient(135deg, var(--cyan), var(--teal));
            color: white;
            padding: 18px 40px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 30px;
        }

        .start-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.3);
        }

        .time-estimate {
            margin-top: 15px;
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* Template Selection Screen */
        .template-screen {
            display: none;
        }

        .template-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .template-title {
            font-size: 36px;
            margin-bottom: 15px;
        }

        .template-subtitle {
            color: var(--text-secondary);
            font-size: 18px;
        }

        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            max-width: 900px;
            margin: 0 auto;
        }

        .template-card {
            background: var(--dark-card);
            border: 2px solid var(--dark-border);
            border-radius: 12px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .template-card:hover {
            border-color: var(--cyan);
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.2);
        }

        .template-icon {
            font-size: 36px;
            margin-bottom: 15px;
            display: block;
        }

        .template-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .template-categories {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Input Screen */
        .input-screen {
            display: none;
        }

        .input-header {
            margin-bottom: 30px;
        }

        .input-title {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .input-instructions {
            color: var(--text-secondary);
        }

        .input-table-container {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid var(--dark-border);
            overflow-x: auto;
        }

        .input-table {
            width: 100%;
            border-collapse: collapse;
        }

        .input-table th {
            text-align: left;
            padding: 15px 10px;
            border-bottom: 2px solid var(--dark-border);
            color: var(--cyan);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .input-table td {
            padding: 15px 10px;
            border-bottom: 1px solid var(--dark-border);
        }

        .input-table input[type="text"],
        .input-table input[type="number"],
        .input-table select {
            width: 100%;
            padding: 10px;
            background: rgba(0, 212, 255, 0.05);
            border: 1px solid rgba(0, 212, 255, 0.2);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 14px;
        }

        .input-table input:focus,
        .input-table select:focus {
            outline: none;
            border-color: var(--cyan);
            background: rgba(0, 212, 255, 0.1);
        }

        .delete-row {
            background: transparent;
            border: 1px solid var(--red);
            color: var(--red);
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        .delete-row:hover {
            background: var(--red);
            color: white;
        }

        .add-row-button {
            background: transparent;
            border: 1px solid var(--cyan);
            color: var(--cyan);
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
            transition: all 0.3s;
        }

        .add-row-button:hover {
            background: var(--cyan);
            color: var(--dark-bg);
        }

        .total-spend {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid var(--dark-border);
            text-align: right;
        }

        .total-label {
            font-size: 16px;
            color: var(--text-secondary);
        }

        .total-amount {
            font-size: 24px;
            font-weight: 600;
            color: var(--cyan);
        }

        .generate-button {
            background: linear-gradient(135deg, var(--cyan), var(--teal));
            color: white;
            padding: 16px 32px;
            border-radius: 8px;
            font-size: 17px;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-top: 30px;
        }

        .generate-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.3);
        }

        .generate-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Results Screen */
        .results-screen {
            display: none;
        }

        /* Visualization Section */
        .visualization-container {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            border: 1px solid var(--dark-border);
        }

        .visualization-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .visualization-title {
            font-size: 24px;
            color: var(--cyan);
        }

        .view-toggle {
            display: flex;
            gap: 10px;
        }

        .toggle-button {
            background: transparent;
            border: 1px solid var(--dark-border);
            color: var(--text-secondary);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .toggle-button.active {
            background: var(--cyan);
            color: var(--dark-bg);
            border-color: var(--cyan);
        }

        .bubble-chart {
            min-height: 400px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .bubble {
            position: relative;
            border-radius: 12px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }

        .bubble:hover {
            transform: scale(1.05);
            z-index: 10;
        }

        .bubble.high-confidence {
            background: rgba(16, 163, 127, 0.2);
            border: 2px solid var(--green);
        }

        .bubble.medium-confidence {
            background: rgba(255, 149, 0, 0.2);
            border: 2px solid var(--amber);
        }

        .bubble.low-confidence {
            background: rgba(220, 38, 38, 0.2);
            border: 2px solid var(--red);
        }

        .bubble-name {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .bubble-emissions {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--dark-border);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        /* Rankings Section */
        .rankings-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .ranking-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid var(--dark-border);
        }

        .ranking-title {
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--cyan);
            margin-bottom: 20px;
            text-align: center;
        }

        .ranking-list {
            list-style: none;
        }

        .ranking-item {
            padding: 15px;
            margin-bottom: 10px;
            background: var(--dark-bg);
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ranking-position {
            font-size: 20px;
            font-weight: 700;
            color: var(--cyan);
            margin-right: 15px;
        }

        .ranking-name {
            flex: 1;
            font-size: 14px;
        }

        .ranking-value {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .priority-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .priority-high {
            background: rgba(220, 38, 38, 0.2);
            color: var(--red);
        }

        .priority-medium {
            background: rgba(255, 149, 0, 0.2);
            color: var(--amber);
        }

        .priority-low {
            background: rgba(107, 114, 128, 0.2);
            color: var(--gray);
        }

        /* Geographic Risk Analysis */
        .geographic-container {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            border: 1px solid var(--dark-border);
        }

        .section-heading {
            font-size: 24px;
            margin-bottom: 30px;
            color: var(--cyan);
        }

        .region-grid {
            display: grid;
            gap: 20px;
        }

        .region-category {
            margin-bottom: 20px;
        }

        .risk-label {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .risk-high {
            color: var(--red);
        }

        .risk-medium {
            color: var(--amber);
        }

        .risk-low {
            color: var(--green);
        }

        .region-items {
            display: grid;
            gap: 10px;
        }

        .region-item {
            background: var(--dark-bg);
            border-radius: 8px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .region-name {
            font-size: 16px;
            font-weight: 500;
        }

        .region-stats {
            text-align: right;
        }

        .region-spend {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .region-emissions {
            font-size: 14px;
            color: var(--cyan);
        }

        .insight-box {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid var(--cyan);
            border-radius: 12px;
            padding: 20px;
            margin-top: 25px;
        }

        .insight-icon {
            color: var(--cyan);
            margin-right: 10px;
        }

        /* Data Confidence Section */
        .confidence-container {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            border: 1px solid var(--dark-border);
        }

        .confidence-details {
            display: grid;
            gap: 20px;
        }

        .confidence-card {
            background: var(--dark-bg);
            border-radius: 12px;
            padding: 25px;
            border-left: 4px solid var(--red);
        }

        .confidence-category {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .confidence-level {
            font-size: 14px;
            margin-bottom: 15px;
        }

        .confidence-reasons {
            list-style: none;
            margin-bottom: 15px;
        }

        .confidence-reasons li {
            padding: 8px 0;
            color: var(--text-secondary);
            font-size: 14px;
            padding-left: 20px;
            position: relative;
        }

        .confidence-reasons li::before {
            content: "‚Ä¢";
            position: absolute;
            left: 0;
            color: var(--amber);
        }

        .confidence-range {
            background: rgba(255, 149, 0, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .range-label {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--amber);
            margin-bottom: 10px;
        }

        .range-values {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }

        .confidence-tip {
            background: rgba(0, 212, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-size: 14px;
            color: var(--cyan);
        }

        /* Strategic Recommendations */
        .recommendations-container {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            border: 1px solid var(--dark-border);
        }

        .recommendation-cards {
            display: grid;
            gap: 20px;
        }

        .recommendation-card {
            background: var(--dark-bg);
            border-radius: 12px;
            padding: 25px;
            border-left: 4px solid var(--cyan);
        }

        .recommendation-number {
            font-size: 24px;
            margin-bottom: 15px;
        }

        .recommendation-title {
            font-size: 18px;
            color: var(--cyan);
            margin-bottom: 15px;
        }

        .recommendation-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .metric-item {
            font-size: 14px;
        }

        .metric-label {
            color: var(--text-secondary);
        }

        .metric-value {
            color: var(--text-primary);
            font-weight: 600;
        }

        .recommendation-action {
            background: rgba(0, 212, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-size: 14px;
        }

        .action-label {
            color: var(--cyan);
            font-weight: 600;
            margin-bottom: 5px;
        }

        /* Summary Card */
        .summary-container {
            background: linear-gradient(135deg, var(--dark-card) 0%, var(--dark-bg) 100%);
            border: 2px solid var(--cyan);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
        }

        .summary-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--dark-border);
        }

        .summary-title {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--cyan);
        }

        .summary-date {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .summary-content {
            display: grid;
            gap: 30px;
        }

        .summary-total {
            text-align: center;
            font-size: 32px;
            font-weight: 700;
            color: var(--cyan);
            margin-bottom: 30px;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .summary-section {
            background: var(--dark-bg);
            border-radius: 12px;
            padding: 20px;
        }

        .summary-section-title {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--cyan);
            margin-bottom: 15px;
        }

        .summary-list {
            list-style: none;
        }

        .summary-list li {
            padding: 8px 0;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .summary-insight {
            background: rgba(0, 212, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }

        .summary-insight-label {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--cyan);
            margin-bottom: 10px;
        }

        .summary-insight-text {
            font-size: 16px;
            color: var(--text-primary);
            font-weight: 500;
        }

        .summary-actions {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            justify-content: center;
        }

        .summary-button {
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
        }

        .download-button {
            background: var(--cyan);
            color: var(--dark-bg);
        }

        .download-button:hover {
            background: var(--teal);
        }

        .print-button {
            background: transparent;
            border: 1px solid var(--cyan);
            color: var(--cyan);
        }

        .print-button:hover {
            background: var(--cyan);
            color: var(--dark-bg);
        }

        /* CTA Section */
        .cta-container {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(0, 180, 216, 0.05));
            border-radius: 20px;
            padding: 50px;
            text-align: center;
            border: 1px solid rgba(0, 212, 255, 0.2);
            margin-bottom: 40px;
        }

        .cta-title {
            font-size: 36px;
            margin-bottom: 20px;
        }

        .cta-text {
            font-size: 18px;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        .cta-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .cta-button {
            padding: 16px 32px;
            border-radius: 8px;
            font-size: 17px;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.3s;
            display: inline-block;
        }

        .cta-primary {
            background: linear-gradient(135deg, var(--cyan), var(--teal));
            color: white;
        }

        .cta-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.3);
        }

        .cta-secondary {
            background: transparent;
            color: var(--cyan);
            border: 1px solid var(--cyan);
        }

        .cta-secondary:hover {
            background: rgba(0, 212, 255, 0.1);
        }

        .secondary-links {
            margin-top: 30px;
        }

        .secondary-links a {
            color: var(--text-secondary);
            text-decoration: none;
            margin: 0 15px;
            font-size: 14px;
        }

        .secondary-links a:hover {
            color: var(--cyan);
        }

        /* Footer */
        footer {
            padding: 50px 22px;
            border-top: 1px solid var(--dark-border);
            text-align: center;
            margin-top: 100px;
        }

        .footer-links {
            margin-bottom: 20px;
        }

        .footer-links a {
            color: var(--cyan);
            text-decoration: none;
            margin: 0 15px;
            font-size: 14px;
        }

        .footer-text {
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
                color: black;
            }

            nav, footer, .cta-container, .secondary-links {
                display: none;
            }

            .summary-container {
                page-break-inside: avoid;
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 42px;
            }

            .template-grid {
                grid-template-columns: 1fr;
            }

            .rankings-container {
                grid-template-columns: 1fr;
            }

            .summary-grid {
                grid-template-columns: 1fr;
            }

            .cta-buttons {
                flex-direction: column;
            }

            .cta-button {
                width: 100%;
            }

            .mobile-warning {
                display: block;
                background: rgba(255, 149, 0, 0.1);
                border: 1px solid var(--amber);
                border-radius: 12px;
                padding: 20px;
                margin: 20px;
                text-align: center;
            }
        }

        .mobile-warning {
            display: none;
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="nav-content">
            <a href="index.html" class="logo">PROMETHEUS</a>
            <div class="breadcrumb">
                <a href="index.html">PROMETHEUS</a> > 
                <a href="demos.html">Demos</a> > 
                Carbon Hotspot Mapper
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Mobile Warning -->
        <div class="mobile-warning">
            <p>For the best experience, please use a desktop or tablet to access the full strategic planning features.</p>
        </div>

        <!-- Welcome Screen -->
        <div class="welcome-screen" id="welcomeScreen">
            <div class="badge">STRATEGIC PLANNING TOOL</div>
            <h1>Supply Chain Carbon Hotspot Mapper</h1>
            <p class="subhead">
                Visualize where your carbon risk concentrates. Identify which procurement categories 
                and sourcing regions should be your first priority for primary data collection.
            </p>
            <p class="context">
                Not all Scope 3 categories are equal. Some drive massive emissions, others are negligible. 
                Some have reliable emission factors, others are guesswork. Some sourcing regions have clean 
                energy grids, others are carbon-intensive. This mapper helps you see the full picture 
                and prioritize strategically.
            </p>
            
            <div class="learn-list">
                <h3>What you'll discover:</h3>
                <ul>
                    <li>Which categories drive the most emissions</li>
                    <li>Which regions carry highest carbon risk</li>
                    <li>Where your data confidence is lowest</li>
                    <li>A prioritized action plan for data collection</li>
                </ul>
            </div>
            
            <button class="start-button" onclick="startMapping()">
                Map My Hotspots ‚Üí
            </button>
            <p class="time-estimate">Estimated time: 10 minutes</p>
        </div>

        <!-- Template Selection Screen -->
        <div class="template-screen" id="templateScreen">
            <div class="template-header">
                <h2 class="template-title">Select Your Industry Template</h2>
                <p class="template-subtitle">Choose a pre-populated template or start from scratch</p>
            </div>

            <div class="template-grid">
                <div class="template-card" onclick="loadTemplate('automotive')">
                    <span class="template-icon">üöó</span>
                    <div class="template-name">Automotive</div>
                    <div class="template-categories">8 categories</div>
                </div>

                <div class="template-card" onclick="loadTemplate('consumer')">
                    <span class="template-icon">üõçÔ∏è</span>
                    <div class="template-name">Consumer Goods</div>
                    <div class="template-categories">8 categories</div>
                </div>

                <div class="template-card" onclick="loadTemplate('electronics')">
                    <span class="template-icon">üíª</span>
                    <div class="template-name">Electronics & Tech</div>
                    <div class="template-categories">9 categories</div>
                </div>

                <div class="template-card" onclick="loadTemplate('food')">
                    <span class="template-icon">üçî</span>
                    <div class="template-name">Food & Beverage</div>
                    <div class="template-categories">8 categories</div>
                </div>

                <div class="template-card" onclick="loadTemplate('manufacturing')">
                    <span class="template-icon">üè≠</span>
                    <div class="template-name">Industrial</div>
                    <div class="template-categories">8 categories</div>
                </div>

                <div class="template-card" onclick="loadTemplate('custom')">
                    <span class="template-icon">‚úèÔ∏è</span>
                    <div class="template-name">Custom</div>
                    <div class="template-categories">Start blank</div>
                </div>
            </div>
        </div>

        <!-- Input Screen -->
        <div class="input-screen" id="inputScreen">
            <div class="input-header">
                <h2 class="input-title">Enter Your Procurement Categories</h2>
                <p class="input-instructions">Add your key procurement categories with spend and sourcing data</p>
            </div>

            <div class="input-table-container">
                <table class="input-table">
                    <thead>
                        <tr>
                            <th>Category Name</th>
                            <th>Annual Spend (‚Ç¨)</th>
                            <th>Primary Sourcing Region</th>
                            <th>Material Type</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="categoryTableBody">
                        <!-- Rows will be dynamically added -->
                    </tbody>
                </table>

                <button class="add-row-button" onclick="addCategoryRow()">+ Add Category</button>

                <div class="total-spend">
                    <span class="total-label">Total Annual Spend:</span>
                    <span class="total-amount" id="totalSpend">‚Ç¨0</span>
                </div>
            </div>

            <button class="generate-button" id="generateButton" onclick="generateHotspotMap()">
                Generate Hotspot Map ‚Üí
            </button>
        </div>

        <!-- Results Screen -->
        <div class="results-screen" id="resultsScreen">
            <!-- Visualization -->
            <div class="visualization-container">
                <div class="visualization-header">
                    <h2 class="visualization-title">YOUR CARBON HOTSPOT MAP</h2>
                    <div class="view-toggle">
                        <button class="toggle-button active" onclick="changeView('category')">By Category</button>
                        <button class="toggle-button" onclick="changeView('region')">By Region</button>
                        <button class="toggle-button" onclick="changeView('confidence')">By Confidence</button>
                    </div>
                </div>

                <div class="bubble-chart" id="bubbleChart">
                    <!-- Bubbles will be dynamically generated -->
                </div>

                <div class="legend">
                    <div class="legend-item">
                        <span class="legend-dot" style="background: var(--green)"></span>
                        <span>High Confidence</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-dot" style="background: var(--amber)"></span>
                        <span>Medium Confidence</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-dot" style="background: var(--red)"></span>
                        <span>Low Confidence</span>
                    </div>
                </div>
            </div>

            <!-- Rankings -->
            <div class="rankings-container">
                <div class="ranking-card">
                    <h3 class="ranking-title">HIGHEST EMISSIONS</h3>
                    <ul class="ranking-list" id="emissionsRanking">
                        <!-- Will be populated -->
                    </ul>
                </div>

                <div class="ranking-card">
                    <h3 class="ranking-title">LOWEST CONFIDENCE</h3>
                    <ul class="ranking-list" id="confidenceRanking">
                        <!-- Will be populated -->
                    </ul>
                </div>

                <div class="ranking-card">
                    <h3 class="ranking-title">PRIORITY RANKING</h3>
                    <ul class="ranking-list" id="priorityRanking">
                        <!-- Will be populated -->
                    </ul>
                </div>
            </div>

            <!-- Geographic Risk Analysis -->
            <div class="geographic-container">
                <h2 class="section-heading">GEOGRAPHIC CARBON RISK</h2>
                
                <div class="region-grid" id="regionAnalysis">
                    <!-- Will be populated -->
                </div>

                <div class="insight-box">
                    <span class="insight-icon">üí°</span>
                    <span id="geographicInsight">Loading insights...</span>
                </div>
            </div>

            <!-- Data Confidence Breakdown -->
            <div class="confidence-container">
                <h2 class="section-heading">WHY YOUR DATA CONFIDENCE VARIES</h2>
                
                <div class="confidence-details" id="confidenceDetails">
                    <!-- Will be populated with low confidence categories -->
                </div>
            </div>

            <!-- Strategic Recommendations -->
            <div class="recommendations-container">
                <h2 class="section-heading">YOUR DATA COLLECTION PRIORITIES</h2>
                <p style="margin-bottom: 30px; color: var(--text-secondary);">
                    Focus your resources here for maximum impact:
                </p>

                <div class="recommendation-cards" id="recommendations">
                    <!-- Will be populated -->
                </div>
            </div>

            <!-- Summary Card -->
            <div class="summary-container">
                <div class="summary-header">
                    <h2 class="summary-title">SUPPLY CHAIN CARBON HOTSPOT SUMMARY</h2>
                    <p class="summary-date" id="summaryDate">Generated: [Date]</p>
                </div>

                <div class="summary-total" id="summaryTotal">
                    Total Estimated Scope 3: ~95,000 tCO2e (¬±65% uncertainty)
                </div>

                <div class="summary-grid">
                    <div class="summary-section">
                        <h3 class="summary-section-title">TOP 3 HOTSPOTS</h3>
                        <ul class="summary-list" id="summaryHotspots">
                            <!-- Will be populated -->
                        </ul>
                    </div>

                    <div class="summary-section">
                        <h3 class="summary-section-title">TOP 3 DATA PRIORITIES</h3>
                        <ul class="summary-list" id="summaryPriorities">
                            <!-- Will be populated -->
                        </ul>
                    </div>

                    <div class="summary-section">
                        <h3 class="summary-section-title">GEOGRAPHIC RISK</h3>
                        <ul class="summary-list" id="summaryGeographic">
                            <!-- Will be populated -->
                        </ul>
                    </div>

                    <div class="summary-section">
                        <h3 class="summary-section-title">CONFIDENCE LEVEL</h3>
                        <ul class="summary-list" id="summaryConfidence">
                            <!-- Will be populated -->
                        </ul>
                    </div>
                </div>

                <div class="summary-insight">
                    <div class="summary-insight-label">KEY INSIGHT</div>
                    <div class="summary-insight-text" id="keyInsight">
                        Collecting primary data from just 8 suppliers would cover 70% of emissions and reduce uncertainty by 60%
                    </div>
                </div>

                <div class="summary-actions">
                    <button class="summary-button download-button" onclick="downloadSummary()">
                        Download Summary (PDF)
                    </button>
                    <button class="summary-button print-button" onclick="window.print()">
                        Print Summary
                    </button>
                </div>
            </div>

            <!-- CTA Section -->
            <div class="cta-container">
                <h2 class="cta-title">Get Primary Data for Your Hotspots</h2>
                <p class="cta-text">
                    PROMETHEUS connects to your suppliers' systems through federated learning. 
                    They keep their production data private. You get accurate, audit-ready emission 
                    factors for exactly these categories.
                </p>
                <div class="cta-buttons">
                    <a href="index.html" class="cta-button cta-primary">See How PROMETHEUS Works ‚Üí</a>
                    <a href="mailto:contact@e-group.hu" class="cta-button cta-secondary">Request Demo</a>
                </div>
                <div class="secondary-links">
                    <a href="demos.html">‚Üê Back to All Tools</a>
                    <a href="csrd-readiness-scorecard.html">Try CSRD Readiness Scorecard ‚Üí</a>
                    <a href="scope3-gap-analyzer.html">Try Scope 3 Gap Analyzer ‚Üí</a>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-links">
            <a href="index.html">Back to PROMETHEUS</a>
            <a href="demos.html">All Assessments</a>
        </div>
        <p class="footer-text">
            ¬© 2025 E-Group. PROMETHEUS ‚Äî Federated Carbon Intelligence Network.
        </p>
    </footer>

    <script>
        // Reference Data
        const gridIntensity = {
            'Western Europe': 350,
            'Northern Europe': 65,
            'Southern Europe': 280,
            'Eastern Europe': 600,
            'United Kingdom': 250,
            'North America': 400,
            'China': 550,
            'Southeast Asia': 500,
            'India': 700,
            'Japan / South Korea': 450,
            'South America': 200,
            'Middle East': 600,
            'Africa': 500,
            'Mixed / Global': 450
        };

        const emissionFactors = {
            'Metals & Mining': 1400,
            'Chemicals & Plastics': 1050,
            'Electronics & Semiconductors': 800,
            'Textiles & Apparel': 750,
            'Agriculture & Food': 550,
            'Paper & Packaging': 400,
            'Energy & Utilities': 500,
            'Transportation & Logistics': 500,
            'Professional Services': 100,
            'Construction & Infrastructure': 900,
            'Other Manufacturing': 700
        };

        const industryTemplates = {
            automotive: [
                { name: 'Raw Materials (steel, aluminum)', spend: '', region: 'China', material: 'Metals & Mining' },
                { name: 'Electronic Components', spend: '', region: 'Southeast Asia', material: 'Electronics & Semiconductors' },
                { name: 'Batteries / Powertrain', spend: '', region: 'China', material: 'Electronics & Semiconductors' },
                { name: 'Logistics / Transportation', spend: '', region: 'Mixed / Global', material: 'Transportation & Logistics' },
                { name: 'Packaging', spend: '', region: 'Western Europe', material: 'Paper & Packaging' },
                { name: 'Tooling & Equipment', spend: '', region: 'Germany', material: 'Other Manufacturing' },
                { name: 'Professional Services', spend: '', region: 'Western Europe', material: 'Professional Services' },
                { name: 'Utilities / Energy', spend: '', region: 'Western Europe', material: 'Energy & Utilities' }
            ],
            consumer: [
                { name: 'Ingredients / Raw Materials', spend: '', region: 'Mixed / Global', material: 'Agriculture & Food' },
                { name: 'Packaging (primary)', spend: '', region: 'Western Europe', material: 'Paper & Packaging' },
                { name: 'Packaging (secondary)', spend: '', region: 'Eastern Europe', material: 'Paper & Packaging' },
                { name: 'Contract Manufacturing', spend: '', region: 'China', material: 'Other Manufacturing' },
                { name: 'Distribution / Logistics', spend: '', region: 'Mixed / Global', material: 'Transportation & Logistics' },
                { name: 'Retail Operations', spend: '', region: 'Western Europe', material: 'Professional Services' },
                { name: 'Marketing / Services', spend: '', region: 'Western Europe', material: 'Professional Services' },
                { name: 'Waste Management', spend: '', region: 'Western Europe', material: 'Other Manufacturing' }
            ],
            electronics: [
                { name: 'Semiconductors / Chips', spend: '', region: 'Southeast Asia', material: 'Electronics & Semiconductors' },
                { name: 'Display Components', spend: '', region: 'China', material: 'Electronics & Semiconductors' },
                { name: 'Batteries', spend: '', region: 'China', material: 'Electronics & Semiconductors' },
                { name: 'Metals & Minerals', spend: '', region: 'South America', material: 'Metals & Mining' },
                { name: 'PCBs & Substrates', spend: '', region: 'China', material: 'Electronics & Semiconductors' },
                { name: 'Assembly Services', spend: '', region: 'China', material: 'Other Manufacturing' },
                { name: 'Logistics', spend: '', region: 'Mixed / Global', material: 'Transportation & Logistics' },
                { name: 'Data Center Services', spend: '', region: 'North America', material: 'Professional Services' },
                { name: 'Packaging', spend: '', region: 'Southeast Asia', material: 'Paper & Packaging' }
            ],
            food: [
                { name: 'Agricultural Ingredients', spend: '', region: 'Mixed / Global', material: 'Agriculture & Food' },
                { name: 'Packaging (primary)', spend: '', region: 'Western Europe', material: 'Paper & Packaging' },
                { name: 'Packaging (secondary)', spend: '', region: 'Eastern Europe', material: 'Paper & Packaging' },
                { name: 'Processing / Co-packing', spend: '', region: 'Western Europe', material: 'Agriculture & Food' },
                { name: 'Cold Chain / Logistics', spend: '', region: 'Mixed / Global', material: 'Transportation & Logistics' },
                { name: 'Retail / Distribution', spend: '', region: 'Western Europe', material: 'Professional Services' },
                { name: 'Utilities / Energy', spend: '', region: 'Western Europe', material: 'Energy & Utilities' },
                { name: 'Waste Management', spend: '', region: 'Western Europe', material: 'Other Manufacturing' }
            ],
            manufacturing: [
                { name: 'Raw Materials (metals)', spend: '', region: 'China', material: 'Metals & Mining' },
                { name: 'Raw Materials (chemicals)', spend: '', region: 'Western Europe', material: 'Chemicals & Plastics' },
                { name: 'Components / Sub-assemblies', spend: '', region: 'Eastern Europe', material: 'Other Manufacturing' },
                { name: 'Utilities / Energy', spend: '', region: 'Western Europe', material: 'Energy & Utilities' },
                { name: 'Logistics (inbound)', spend: '', region: 'Mixed / Global', material: 'Transportation & Logistics' },
                { name: 'Logistics (outbound)', spend: '', region: 'Mixed / Global', material: 'Transportation & Logistics' },
                { name: 'Packaging', spend: '', region: 'Western Europe', material: 'Paper & Packaging' },
                { name: 'Maintenance & Services', spend: '', region: 'Western Europe', material: 'Professional Services' }
            ],
            custom: []
        };

        let categories = [];
        let currentView = 'category';

        // Start Mapping
        function startMapping() {
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('templateScreen').style.display = 'block';
        }

        // Load Template
        function loadTemplate(templateType) {
            document.getElementById('templateScreen').style.display = 'none';
            document.getElementById('inputScreen').style.display = 'block';
            
            const template = industryTemplates[templateType] || [];
            categories = [...template];
            
            renderCategoryTable();
        }

        // Render Category Table
        function renderCategoryTable() {
            const tbody = document.getElementById('categoryTableBody');
            tbody.innerHTML = '';
            
            categories.forEach((cat, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><input type="text" value="${cat.name}" onchange="updateCategory(${index}, 'name', this.value)" placeholder="Category name..."></td>
                    <td><input type="number" value="${cat.spend}" onchange="updateCategory(${index}, 'spend', this.value)" placeholder="0"></td>
                    <td>
                        <select onchange="updateCategory(${index}, 'region', this.value)">
                            <option value="">Select region...</option>
                            ${Object.keys(gridIntensity).map(region => 
                                `<option value="${region}" ${cat.region === region ? 'selected' : ''}>${region}</option>`
                            ).join('')}
                        </select>
                    </td>
                    <td>
                        <select onchange="updateCategory(${index}, 'material', this.value)">
                            <option value="">Select material...</option>
                            ${Object.keys(emissionFactors).map(material => 
                                `<option value="${material}" ${cat.material === material ? 'selected' : ''}>${material}</option>`
                            ).join('')}
                        </select>
                    </td>
                    <td><button class="delete-row" onclick="deleteCategory(${index})">Delete</button></td>
                `;
                tbody.appendChild(row);
            });
            
            updateTotalSpend();
        }

        // Add Category Row
        function addCategoryRow() {
            categories.push({
                name: '',
                spend: '',
                region: '',
                material: ''
            });
            renderCategoryTable();
        }

        // Update Category
        function updateCategory(index, field, value) {
            categories[index][field] = value;
            updateTotalSpend();
        }

        // Delete Category
        function deleteCategory(index) {
            categories.splice(index, 1);
            renderCategoryTable();
        }

        // Update Total Spend
        function updateTotalSpend() {
            const total = categories.reduce((sum, cat) => sum + (parseFloat(cat.spend) || 0), 0);
            document.getElementById('totalSpend').textContent = `‚Ç¨${total.toLocaleString()}`;
            
            // Enable/disable generate button
            const hasValidData = categories.some(cat => cat.name && cat.spend && cat.region && cat.material);
            document.getElementById('generateButton').disabled = !hasValidData;
        }

        // Generate Hotspot Map
        function generateHotspotMap() {
            // Calculate emissions and confidence for each category
            categories = categories.filter(cat => cat.name && cat.spend && cat.region && cat.material)
                .map(cat => {
                    const spend = parseFloat(cat.spend) || 0;
                    const emissionFactor = emissionFactors[cat.material] || 700;
                    const regionIntensity = gridIntensity[cat.region] || 450;
                    
                    // Calculate emissions (simplified formula)
                    const baseEmissions = (spend / 1000000) * emissionFactor;
                    const regionMultiplier = regionIntensity / 400; // Normalize to average
                    const emissions = Math.round(baseEmissions * regionMultiplier);
                    
                    // Determine confidence based on material type and region
                    let confidence;
                    if (cat.material === 'Professional Services' || cat.region === 'Western Europe') {
                        confidence = 'high';
                    } else if (cat.material.includes('Electronics') || cat.region === 'China') {
                        confidence = 'low';
                    } else {
                        confidence = 'medium';
                    }
                    
                    return {
                        ...cat,
                        emissions,
                        confidence,
                        uncertainty: confidence === 'high' ? 20 : confidence === 'medium' ? 60 : 150
                    };
                });

            // Hide input, show results
            document.getElementById('inputScreen').style.display = 'none';
            document.getElementById('resultsScreen').style.display = 'block';

            // Generate visualizations and analysis
            generateBubbleChart();
            generateRankings();
            generateGeographicAnalysis();
            generateConfidenceDetails();
            generateRecommendations();
            generateSummary();
        }

        // Generate Bubble Chart
        function generateBubbleChart() {
            const chart = document.getElementById('bubbleChart');
            chart.innerHTML = '';
            
            // Sort by emissions for better visualization
            const sorted = [...categories].sort((a, b) => b.emissions - a.emissions);
            
            sorted.forEach(cat => {
                const bubble = document.createElement('div');
                bubble.className = `bubble ${cat.confidence}-confidence fade-in`;
                
                // Size based on emissions
                const size = Math.max(100, Math.min(250, cat.emissions / 50));
                bubble.style.width = `${size}px`;
                bubble.style.height = `${size}px`;
                
                bubble.innerHTML = `
                    <div class="bubble-name">${cat.name}</div>
                    <div class="bubble-emissions">~${cat.emissions.toLocaleString()} tCO2e</div>
                `;
                
                chart.appendChild(bubble);
            });
        }

        // Generate Rankings
        function generateRankings() {
            // Emissions ranking
            const emissionsSorted = [...categories].sort((a, b) => b.emissions - a.emissions);
            const emissionsRanking = document.getElementById('emissionsRanking');
            emissionsRanking.innerHTML = '';
            
            emissionsSorted.slice(0, 4).forEach((cat, index) => {
                const item = document.createElement('li');
                item.className = 'ranking-item';
                item.innerHTML = `
                    <span class="ranking-position">${index + 1}</span>
                    <span class="ranking-name">${cat.name}</span>
                    <span class="ranking-value">~${cat.emissions.toLocaleString()} tCO2e</span>
                `;
                emissionsRanking.appendChild(item);
            });
            
            // Confidence ranking (lowest confidence first)
            const confidenceSorted = [...categories].sort((a, b) => b.uncertainty - a.uncertainty);
            const confidenceRanking = document.getElementById('confidenceRanking');
            confidenceRanking.innerHTML = '';
            
            confidenceSorted.slice(0, 4).forEach((cat, index) => {
                const item = document.createElement('li');
                item.className = 'ranking-item';
                item.innerHTML = `
                    <span class="ranking-position">${index + 1}</span>
                    <span class="ranking-name">${cat.name}</span>
                    <span class="ranking-value">¬±${cat.uncertainty}% range</span>
                `;
                confidenceRanking.appendChild(item);
            });
            
            // Priority ranking (combined score)
            const prioritySorted = [...categories].sort((a, b) => {
                const scoreA = a.emissions * (a.uncertainty / 100);
                const scoreB = b.emissions * (b.uncertainty / 100);
                return scoreB - scoreA;
            });
            const priorityRanking = document.getElementById('priorityRanking');
            priorityRanking.innerHTML = '';
            
            prioritySorted.slice(0, 4).forEach((cat, index) => {
                const item = document.createElement('li');
                item.className = 'ranking-item';
                const priority = index < 2 ? 'high' : 'medium';
                item.innerHTML = `
                    <span class="ranking-position">${index + 1}</span>
                    <span class="ranking-name">${cat.name}</span>
                    <span class="priority-badge priority-${priority}">${priority}</span>
                `;
                priorityRanking.appendChild(item);
            });
        }

        // Generate Geographic Analysis
        function generateGeographicAnalysis() {
            const regionData = {};
            
            // Aggregate by region
            categories.forEach(cat => {
                if (!regionData[cat.region]) {
                    regionData[cat.region] = {
                        spend: 0,
                        emissions: 0,
                        intensity: gridIntensity[cat.region]
                    };
                }
                regionData[cat.region].spend += parseFloat(cat.spend) || 0;
                regionData[cat.region].emissions += cat.emissions;
            });
            
            const container = document.getElementById('regionAnalysis');
            container.innerHTML = '';
            
            // Group by risk level
            const highRisk = [];
            const mediumRisk = [];
            const lowRisk = [];
            
            Object.entries(regionData).forEach(([region, data]) => {
                const item = { region, ...data };
                if (data.intensity > 400) {
                    highRisk.push(item);
                } else if (data.intensity > 200) {
                    mediumRisk.push(item);
                } else {
                    lowRisk.push(item);
                }
            });
            
            // Render risk categories
            if (highRisk.length > 0) {
                const highDiv = document.createElement('div');
                highDiv.className = 'region-category';
                highDiv.innerHTML = `
                    <div class="risk-label risk-high">üî¥ HIGH RISK (>400g CO2/kWh)</div>
                    <div class="region-items">
                        ${highRisk.map(r => `
                            <div class="region-item">
                                <div class="region-name">${r.region}</div>
                                <div class="region-stats">
                                    <div class="region-spend">‚Ç¨${(r.spend / 1000000).toFixed(1)}M spend</div>
                                    <div class="region-emissions">~${r.emissions.toLocaleString()} tCO2e</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(highDiv);
            }
            
            if (mediumRisk.length > 0) {
                const medDiv = document.createElement('div');
                medDiv.className = 'region-category';
                medDiv.innerHTML = `
                    <div class="risk-label risk-medium">üü° MEDIUM RISK (200-400g CO2/kWh)</div>
                    <div class="region-items">
                        ${mediumRisk.map(r => `
                            <div class="region-item">
                                <div class="region-name">${r.region}</div>
                                <div class="region-stats">
                                    <div class="region-spend">‚Ç¨${(r.spend / 1000000).toFixed(1)}M spend</div>
                                    <div class="region-emissions">~${r.emissions.toLocaleString()} tCO2e</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(medDiv);
            }
            
            if (lowRisk.length > 0) {
                const lowDiv = document.createElement('div');
                lowDiv.className = 'region-category';
                lowDiv.innerHTML = `
                    <div class="risk-label risk-low">üü¢ LOW RISK (<200g CO2/kWh)</div>
                    <div class="region-items">
                        ${lowRisk.map(r => `
                            <div class="region-item">
                                <div class="region-name">${r.region}</div>
                                <div class="region-stats">
                                    <div class="region-spend">‚Ç¨${(r.spend / 1000000).toFixed(1)}M spend</div>
                                    <div class="region-emissions">~${r.emissions.toLocaleString()} tCO2e</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(lowDiv);
            }
            
            // Generate insight
            if (highRisk.length > 0 && lowRisk.length > 0) {
                const potentialSaving = Math.round(highRisk[0].emissions * 0.3);
                document.getElementById('geographicInsight').textContent = 
                    `Shifting ‚Ç¨1M from ${highRisk[0].region} to a low-carbon region could save ~${potentialSaving.toLocaleString()} tCO2e`;
            }
        }

        // Generate Confidence Details
        function generateConfidenceDetails() {
            const container = document.getElementById('confidenceDetails');
            container.innerHTML = '';
            
            const lowConfidence = categories.filter(cat => cat.confidence === 'low').slice(0, 3);
            
            lowConfidence.forEach(cat => {
                const card = document.createElement('div');
                card.className = 'confidence-card';
                card.innerHTML = `
                    <h3 class="confidence-category">${cat.name}</h3>
                    <div class="confidence-level">Confidence: LOW (¬±${cat.uncertainty}% range)</div>
                    
                    <div style="margin-bottom: 15px;">Reasons:</div>
                    <ul class="confidence-reasons">
                        ${getConfidenceReasons(cat.material).map(r => `<li>${r}</li>`).join('')}
                    </ul>
                    
                    <div class="confidence-range">
                        <div class="range-label">Uncertainty Range</div>
                        <div class="range-values">
                            <span>Best case: ${Math.round(cat.emissions * 0.5).toLocaleString()} tCO2e</span>
                            <span>Worst case: ${Math.round(cat.emissions * 2.5).toLocaleString()} tCO2e</span>
                        </div>
                    </div>
                    
                    <div class="confidence-tip">
                        üí° Primary data from your top 5 ${cat.name.toLowerCase()} suppliers would reduce uncertainty by 80%
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Get Confidence Reasons
        function getConfidenceReasons(material) {
            const reasons = {
                'Metals & Mining': [
                    'Wide variance in production methods (blast furnace vs EAF)',
                    'Recycled content dramatically changes footprint',
                    'Energy source varies by country (coal vs. renewable)',
                    'No primary supplier data available'
                ],
                'Electronics & Semiconductors': [
                    'Complex supply chains with multiple tiers',
                    'Rapid technology changes affect emissions',
                    'High energy intensity varies by fab location',
                    'Limited transparency from suppliers'
                ],
                'Chemicals & Plastics': [
                    'Feedstock source affects emissions significantly',
                    'Process efficiency varies widely',
                    'Recycled content not well documented',
                    'Energy intensity depends on specific chemicals'
                ]
            };
            
            return reasons[material] || [
                'Industry averages have high variance',
                'Limited primary data available',
                'Production methods vary significantly',
                'No supplier-specific emission factors'
            ];
        }

        // Generate Recommendations
        function generateRecommendations() {
            const container = document.getElementById('recommendations');
            container.innerHTML = '';
            
            // Get top priorities
            const priorities = [...categories].sort((a, b) => {
                const scoreA = a.emissions * (a.uncertainty / 100);
                const scoreB = b.emissions * (b.uncertainty / 100);
                return scoreB - scoreA;
            }).slice(0, 5);
            
            priorities.forEach((cat, index) => {
                const card = document.createElement('div');
                card.className = 'recommendation-card fade-in';
                card.innerHTML = `
                    <div class="recommendation-number">${index + 1}Ô∏è‚É£</div>
                    <h3 class="recommendation-title">${cat.name.toUpperCase()} - Top suppliers</h3>
                    
                    <div class="recommendation-metrics">
                        <div class="metric-item">
                            <span class="metric-label">Impact:</span>
                            <span class="metric-value">Covers ~${Math.round((cat.emissions / getTotalEmissions()) * 100)}% of emissions</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Effort:</span>
                            <span class="metric-value">${getEffortLevel(cat.material)}</span>
                        </div>
                    </div>
                    
                    <div class="recommendation-action">
                        <div class="action-label">Recommendation:</div>
                        <div>${getRecommendation(cat, index)}</div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Get Total Emissions
        function getTotalEmissions() {
            return categories.reduce((sum, cat) => sum + cat.emissions, 0);
        }

        // Get Effort Level
        function getEffortLevel(material) {
            if (material === 'Professional Services' || material === 'Transportation & Logistics') {
                return 'Low';
            } else if (material.includes('Electronics') || material.includes('Metals')) {
                return 'High';
            }
            return 'Medium';
        }

        // Get Recommendation
        function getRecommendation(cat, priority) {
            if (priority === 0) {
                return 'Start here - biggest bang for buck. Request production data from top 5 suppliers.';
            } else if (cat.region === 'China' || cat.region === 'India') {
                return 'Consider alternative suppliers in lower-carbon regions or request renewable energy data.';
            } else if (cat.confidence === 'high') {
                return 'Good data available - quick wins possible. Request carbon reports from suppliers.';
            }
            return 'Request energy source and efficiency data from top 3 suppliers.';
        }

        // Generate Summary
        function generateSummary() {
            const totalEmissions = getTotalEmissions();
            const avgUncertainty = categories.reduce((sum, cat) => sum + cat.uncertainty, 0) / categories.length;
            
            // Update summary date
            document.getElementById('summaryDate').textContent = `Generated: ${new Date().toLocaleDateString()}`;
            
            // Update total
            document.getElementById('summaryTotal').textContent = 
                `Total Estimated Scope 3: ~${totalEmissions.toLocaleString()} tCO2e (¬±${Math.round(avgUncertainty)}% uncertainty)`;
            
            // Top hotspots
            const hotspots = [...categories].sort((a, b) => b.emissions - a.emissions).slice(0, 3);
            document.getElementById('summaryHotspots').innerHTML = hotspots.map((cat, i) => 
                `<li>${i + 1}. ${cat.name} (${Math.round((cat.emissions / totalEmissions) * 100)}%)</li>`
            ).join('');
            
            // Top priorities
            const priorities = [...categories].sort((a, b) => {
                const scoreA = a.emissions * (a.uncertainty / 100);
                const scoreB = b.emissions * (b.uncertainty / 100);
                return scoreB - scoreA;
            }).slice(0, 3);
            document.getElementById('summaryPriorities').innerHTML = priorities.map((cat, i) => 
                `<li>${i + 1}. ${cat.name}</li>`
            ).join('');
            
            // Geographic risk
            const highRiskPercent = Math.round((categories.filter(cat => 
                gridIntensity[cat.region] > 400).length / categories.length) * 100);
            const medRiskPercent = Math.round((categories.filter(cat => 
                gridIntensity[cat.region] > 200 && gridIntensity[cat.region] <= 400).length / categories.length) * 100);
            const lowRiskPercent = 100 - highRiskPercent - medRiskPercent;
            
            document.getElementById('summaryGeographic').innerHTML = `
                <li>üî¥ ${highRiskPercent}% from high-risk</li>
                <li>üü° ${medRiskPercent}% from medium-risk</li>
                <li>üü¢ ${lowRiskPercent}% from low-risk</li>
            `;
            
            // Confidence level
            const lowConfPercent = Math.round((categories.filter(cat => 
                cat.confidence === 'low').length / categories.length) * 100);
            const medConfPercent = Math.round((categories.filter(cat => 
                cat.confidence === 'medium').length / categories.length) * 100);
            const highConfPercent = 100 - lowConfPercent - medConfPercent;
            
            document.getElementById('summaryConfidence').innerHTML = `
                <li>üî¥ ${lowConfPercent}% low confidence</li>
                <li>üü° ${medConfPercent}% medium confidence</li>
                <li>üü¢ ${highConfPercent}% high confidence</li>
            `;
            
            // Key insight
            const topSuppliers = Math.round(categories.length * 0.4);
            const coveragePercent = Math.round((hotspots.reduce((sum, cat) => sum + cat.emissions, 0) / totalEmissions) * 100);
            document.getElementById('keyInsight').textContent = 
                `Collecting primary data from just ${topSuppliers} suppliers would cover ${coveragePercent}% of emissions and reduce uncertainty by 60%`;
        }

        // Change View
        function changeView(view) {
            currentView = view;
            
            // Update toggle buttons
            document.querySelectorAll('.toggle-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Re-render based on view
            if (view === 'region') {
                // Group by region
                generateBubbleChartByRegion();
            } else if (view === 'confidence') {
                // Group by confidence
                generateBubbleChartByConfidence();
            } else {
                // Default category view
                generateBubbleChart();
            }
        }

        // Generate Bubble Chart by Region
        function generateBubbleChartByRegion() {
            const chart = document.getElementById('bubbleChart');
            chart.innerHTML = '';
            
            // Aggregate by region
            const regionData = {};
            categories.forEach(cat => {
                if (!regionData[cat.region]) {
                    regionData[cat.region] = {
                        emissions: 0,
                        categories: [],
                        avgConfidence: 'medium'
                    };
                }
                regionData[cat.region].emissions += cat.emissions;
                regionData[cat.region].categories.push(cat.name);
            });
            
            Object.entries(regionData).forEach(([region, data]) => {
                const bubble = document.createElement('div');
                const intensity = gridIntensity[region];
                const confidence = intensity > 400 ? 'low' : intensity < 200 ? 'high' : 'medium';
                bubble.className = `bubble ${confidence}-confidence fade-in`;
                
                const size = Math.max(120, Math.min(250, data.emissions / 50));
                bubble.style.width = `${size}px`;
                bubble.style.height = `${size}px`;
                
                bubble.innerHTML = `
                    <div class="bubble-name">${region}</div>
                    <div class="bubble-emissions">~${data.emissions.toLocaleString()} tCO2e</div>
                `;
                
                chart.appendChild(bubble);
            });
        }

        // Generate Bubble Chart by Confidence
        function generateBubbleChartByConfidence() {
            const chart = document.getElementById('bubbleChart');
            chart.innerHTML = '';
            
            // Group by confidence
            const confidenceGroups = {
                high: [],
                medium: [],
                low: []
            };
            
            categories.forEach(cat => {
                confidenceGroups[cat.confidence].push(cat);
            });
            
            ['low', 'medium', 'high'].forEach(level => {
                if (confidenceGroups[level].length > 0) {
                    const totalEmissions = confidenceGroups[level].reduce((sum, cat) => sum + cat.emissions, 0);
                    
                    const bubble = document.createElement('div');
                    bubble.className = `bubble ${level}-confidence fade-in`;
                    
                    const size = Math.max(150, Math.min(300, totalEmissions / 50));
                    bubble.style.width = `${size}px`;
                    bubble.style.height = `${size}px`;
                    
                    bubble.innerHTML = `
                        <div class="bubble-name">${level.toUpperCase()} CONFIDENCE</div>
                        <div class="bubble-emissions">~${totalEmissions.toLocaleString()} tCO2e</div>
                        <div style="font-size: 12px; margin-top: 5px;">${confidenceGroups[level].length} categories</div>
                    `;
                    
                    chart.appendChild(bubble);
                }
            });
        }

        // Download Summary (simplified)
        function downloadSummary() {
            alert('PDF download functionality would be implemented in production. For now, please use the Print button.');
        }

        // Initialize with saved data if available
        if (localStorage.getItem('prometheusCategories')) {
            categories = JSON.parse(localStorage.getItem('prometheusCategories'));
        }

        // Save data on changes
        window.addEventListener('beforeunload', () => {
            if (categories.length > 0) {
                localStorage.setItem('prometheusCategories', JSON.stringify(categories));
            }
        });
    </script>

    <!-- Cross-Links Section -->
    <section class="cross-links">
        <div class="cross-links-container">
            <div class="cross-links-header">
                <h2 class="cross-links-title">Explore More Tools</h2>
                <p class="cross-links-subtitle">Continue your carbon intelligence journey with our other assessment tools</p>
            </div>
            
            <div class="tools-grid">
                <!-- CSRD Readiness Scorecard -->
                <a href="csrd-readiness-scorecard.html" class="tool-card">
                    <span class="tool-icon">üìã</span>
                    <h3 class="tool-name">CSRD Readiness Scorecard</h3>
                    <p class="tool-desc">Evaluate your organization's preparedness for CSRD compliance with comprehensive scoring</p>
                </a>

                <!-- Scope 3 Gap Analyzer -->
                <a href="scope3-gap-analyzer.html" class="tool-card">
                    <span class="tool-icon">üîç</span>
                    <h3 class="tool-name">Scope 3 Gap Analyzer</h3>
                    <p class="tool-desc">Identify coverage gaps across all 15 GHG Protocol categories with industry benchmarking</p>
                </a>
            </div>

            <div class="back-to-hub">
                <a href="demos.html" class="hub-link">
                    ‚Üê Back to All Tools
                </a>
            </div>
        </div>
    </section>
</body>
</html>