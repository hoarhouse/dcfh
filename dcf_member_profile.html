<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Profile - DCF Hungary</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f8f9fa;
        }

        .header {
            background: white;
            border-bottom: 1px solid #e5e5e5;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .logo {
            display: flex;
            align-items: center;
            font-weight: 600;
            color: #333;
            text-decoration: none;
        }

        .logo-icon {
            width: 24px;
            height: 24px;
            background: #333;
            border-radius: 50%;
            margin-right: 8px;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-menu a {
            text-decoration: none;
            color: #666;
            font-size: 0.9rem;
            position: relative;
        }

        .nav-menu a.active {
            color: #333;
            font-weight: 600;
        }

        .nav-menu a:hover {
            color: #333;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

       .user-avatar {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #00ff00, #32cd32);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
            box-shadow: 0 0 10px #00ff00;
        }

        .user-avatar:hover {
            transform: scale(1.05);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .user-dropdown {
            position: relative;
        }

        .dropdown-menu {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            border: 1px solid #e5e5e5;
            min-width: 280px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .dropdown-menu.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.5rem;
            border-bottom: 1px solid #f0f0f0;
        }

        .dropdown-avatar {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #00ff00, #32cd32);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
            flex-shrink: 0;
        }

        .dropdown-info {
            flex: 1;
            min-width: 0;
        }

        .dropdown-name {
            font-weight: 600;
            color: #333;
            font-size: 1rem;
            margin-bottom: 0.25rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .dropdown-email {
            color: #666;
            font-size: 0.85rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .dropdown-divider {
            height: 1px;
            background: #f0f0f0;
            margin: 0.5rem 0;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.5rem;
            color: #333;
            text-decoration: none;
            transition: all 0.2s ease;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .dropdown-item:hover {
            background: #f8f9fa;
            color: #000;
        }

        .logout-btn {
            color: #dc3545 !important;
            font-weight: 500;
        }

        .logout-btn:hover {
            background: #fee !important;
            color: #c82333 !important;
        }

        .dropdown-icon {
            font-size: 1rem;
            width: 20px;
            text-align: center;
            flex-shrink: 0;
        }

        .dropdown-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 999;
            display: none;
        }

        .dropdown-overlay.active {
            display: block;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .main-container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        .profile-header {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00ff00, #32cd32);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: white;
            font-weight: 600;
            position: relative;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.3);
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .avatar-upload {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 32px;
            height: 32px;
            background: #333;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: white;
            font-size: 0.8rem;
        }

        .avatar-upload:hover {
            background: #666;
        }

        .profile-info h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: #333;
        }

        .profile-info .subtitle {
            color: #666;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .profile-info .location {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .profile-stats {
            display: flex;
            gap: 2rem;
            margin-top: 1rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .profile-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: #000;
            color: white;
        }

        .btn-primary:hover {
            background: #333;
        }

        .btn-secondary {
            background: transparent;
            color: #666;
            border: 1px solid #e5e5e5;
        }

        .btn-secondary:hover {
            color: #333;
            border-color: #333;
        }

        .content-wrapper {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 2rem;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 1rem;
        }

        .profile-main {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .profile-content {
            padding: 2rem;
        }

        .content-tabs {
            display: flex;
            border-bottom: 1px solid #e5e5e5;
            margin-bottom: 2rem;
        }

        .tab-btn {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
            color: #666;
            font-size: 0.9rem;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            color: #333;
            border-bottom-color: #333;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }

        .edit-btn {
            color: #666;
            font-size: 0.9rem;
            cursor: pointer;
            text-decoration: none;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .edit-btn:hover {
            color: #333;
            background: #f8f9fa;
        }

        /* Show edit buttons only for own profile */
        .edit-controls {
            display: none;
        }

        .is-own-profile .edit-controls {
            display: inline-flex;
        }

        .is-own-profile .view-only-controls {
            display: none;
        }

        .tag-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .tag {
            background: #f8f9fa;
            color: #333;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            border: 1px solid #e5e5e5;
        }

        .tag.highlight {
            background: #000;
            color: white;
            border-color: #000;
        }

        .bio-text {
            color: #666;
            line-height: 1.7;
            margin-bottom: 1.5rem;
        }

        .editable-content {
            position: relative;
        }

        .edit-mode {
            display: none;
        }

        .edit-mode.active {
            display: block;
        }

        .view-mode.editing {
            display: none;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #333;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #333;
        }

        .form-select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
            cursor: pointer;
        }

        .form-select:focus {
            outline: none;
            border-color: #333;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            font-size: 1rem;
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }

        .textarea:focus {
            outline: none;
            border-color: #333;
        }

        .edit-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .activity-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border: 1px solid #e5e5e5;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            background: #f8f9fa;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
        }

        .activity-content {
            flex: 1;
        }

        .activity-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 0.25rem;
        }

        .activity-description {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
        }

        .activity-time {
            color: #999;
            font-size: 0.8rem;
        }

        .sidebar-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .sidebar-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 1rem;
        }

        .connection-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 0;
            border-bottom: 1px solid #f5f5f5;
        }

        .connection-item:last-child {
            border-bottom: none;
        }

        .connection-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #e5e5e5;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 0.8rem;
        }

        .connection-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .connection-info {
            flex: 1;
        }

        .connection-name {
            font-weight: 600;
            color: #333;
            font-size: 0.9rem;
            margin-bottom: 0.1rem;
        }

        .connection-role {
            color: #666;
            font-size: 0.8rem;
        }

        .project-item {
            padding: 1rem;
            border: 1px solid #e5e5e5;
            border-radius: 8px;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .project-item:hover {
            border-color: #333;
            background: #f8f9fa;
        }

        .project-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .project-description {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .project-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: #999;
        }

        .status-badge {
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-active {
            background: #e8f5e8;
            color: #2d7d2d;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .empty-state {
            text-align: center;
            padding: 2rem;
            color: #666;
        }

        .empty-state h3 {
            margin-bottom: 0.5rem;
            color: #333;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }

        @media (max-width: 1024px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }

            .sidebar {
                order: 2;
            }

            .profile-main {
                order: 1;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 0 1rem;
            }

            .profile-header {
                flex-direction: column;
                text-align: center;
            }

            .profile-stats {
                justify-content: center;
            }

            .profile-actions {
                justify-content: center;
            }

            .nav-menu {
                display: none;
            }

            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }

            .content-tabs {
                overflow-x: auto;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
   <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="dcf-master-consolidated.js"></script></head>

<body>
    <header class="header">
        <nav class="nav-container">
            <a href="index.html" class="logo">
                <div class="logo-icon"></div>
                Domus Communis Foundation
            </a>
<ul class="nav-menu" id="navMenu">
                <!-- Navigation will be populated by dcf-master-consolidated.js -->
            </ul>
            <div class="user-menu">
                <div class="user-dropdown">
                    <div class="user-avatar" onclick="toggleUserMenu()" id="userAvatar">SJ</div>
                    <div class="dropdown-menu" id="userDropdown">
                        <<div class="dropdown-header">
                            <div class="dropdown-avatar">DM</div>
                            <div class="dropdown-info">
                                <div class="dropdown-name" id="dropdownUserName">DCF Member</div>
                                <div class="dropdown-email" id="dropdownUserEmail">member@dcfhungary.org</div>
                            </div>
                        </div>
                        <div class="dropdown-divider"></div>
                        <!-- Menu items will be populated by dcf-master-consolidated.js -->
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="main-container">
        <div class="profile-header">
            <div class="profile-avatar" id="profileAvatar">
                SJ
                <div class="avatar-upload edit-controls" onclick="document.getElementById('avatarInput').click()">
                    📷
                </div>
                <input type="file" id="avatarInput" accept="image/*" style="display: none;">
            </div>
            <div class="profile-info">
                <div class="editable-content">
                    <div class="view-mode">
                        <h1 id="displayName">Dr. Sarah Johnson</h1>
                        <p class="subtitle" id="displayTitle">AI Ethics Researcher at Stanford University</p>
                        <p class="location" id="displayLocation">🇺🇸 United States</p>
                    </div>
                    <div class="edit-mode">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="editTitle">Title</label>
                                <select id="editTitle" class="form-select">
                                    <option value="">No title</option>
                                    <option value="Dr.">Dr.</option>
                                    <option value="Prof.">Prof.</option>
                                    <option value="Mr.">Mr.</option>
                                    <option value="Ms.">Ms.</option>
                                    <option value="Mrs.">Mrs.</option>
                                    <option value="Rev.">Rev.</option>
                                    <option value="Fr.">Fr.</option>
                                    <option value="Sr.">Sr.</option>
                                    <option value="Cardinal">Cardinal</option>
                                    <option value="Bishop">Bishop</option>
                                    <option value="Rabbi">Rabbi</option>
                                    <option value="Imam">Imam</option>
                                    <option value="Pastor">Pastor</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="editFirstName">First Name</label>
                                <input type="text" id="editFirstName" class="form-input" value="Sarah">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="editLastName">Last Name</label>
                                <input type="text" id="editLastName" class="form-input" value="Johnson">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="editSubtitle">Professional Title & Organization</label>
                            <input type="text" id="editSubtitle" class="form-input" value="AI Ethics Researcher at Stanford University">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="editLocation">Location</label>
                            <input type="text" id="editLocation" class="form-input" value="United States">
                        </div>
                        <div class="edit-actions">
                            <button class="btn btn-primary" onclick="saveBasicInfo()">💾 Save</button>
                            <button class="btn btn-secondary" onclick="cancelEditBasicInfo()">Cancel</button>
                        </div>
                    </div>
                </div>
                <div class="profile-stats">
                    <div class="stat-item">
                        <div class="stat-number">23</div>
                        <div class="stat-label">Connections</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">4</div>
                        <div class="stat-label">Projects</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">87</div>
                        <div class="stat-label">Contributions</div>
                    </div>
                </div>
                <div class="profile-actions">
                    <button class="btn btn-primary edit-controls" onclick="editBasicInfo()">✏️ Edit Profile</button>
                    <button class="btn btn-secondary view-only-controls">💬 Send Message</button>
                    <button class="btn btn-secondary view-only-controls">🤝 Connect</button>
                    <button class="btn btn-secondary" onclick="shareProfile()">📤 Share Profile</button>
                </div>
            </div>
        </div>

        <div class="content-wrapper">
            <div class="sidebar">
                <div class="card">
                    <h3 class="card-title">Quick Actions</h3>
                     <!-- Quick Actions will be inserted here by dcf-master-consolidated.js -->
                </div>

                <div class="sidebar-card">
                    <h3 class="sidebar-title">Recent Connections</h3>
                    <div class="connection-item">
                        <div class="connection-avatar">JA</div>
                        <div class="connection-info">
                            <div class="connection-name">Gen. John Allen</div>
                            <div class="connection-role">Strategic Advisor</div>
                        </div>
                    </div>
                    <div class="connection-item">
                        <div class="connection-avatar">DM</div>
                        <div class="connection-info">
                            <div class="connection-name">Danielle McLaughlin</div>
                            <div class="connection-role">Legal Strategist</div>
                        </div>
                    </div>
                    <div class="connection-item">
                        <div class="connection-avatar">GS</div>
                        <div class="connection-info">
                            <div class="connection-name">Greg Sim</div>
                            <div class="connection-role">Cybersecurity Expert</div>
                        </div>
                    </div>
                </div>

                <div class="sidebar-card">
                    <h3 class="sidebar-title">Suggested Projects</h3>
                    <div class="project-item" onclick="window.location.href='dcf_projects_home.html'">
                        <div class="project-title">AI Safety Research Hub</div>
                        <div class="project-description">Cross-institutional research collaboration</div>
                        <div class="project-meta">
                            <span>8 members</span>
                            <a href="dcf_projects_home.html" class="btn btn-primary" style="font-size: 0.8rem; padding: 0.3rem 0.8rem;">Join</a>
                        </div>
                    </div>
                    <div class="project-item" onclick="window.location.href='dcf_projects_home.html'">
                        <div class="project-title">Global AI Ethics Summit</div>
                        <div class="project-description">Planning the 2025 annual conference</div>
                        <div class="project-meta">
                            <span>15 members</span>
                            <a href="dcf_projects_home.html" class="btn btn-primary" style="font-size: 0.8rem; padding: 0.3rem 0.8rem;">Join</a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="profile-main">
                <div class="profile-content">
                    <div class="content-tabs">
                        <button class="tab-btn active" onclick="switchTab('about')">About</button>
                        <button class="tab-btn" onclick="switchTab('activity')">Activity</button>
                        <button class="tab-btn" onclick="switchTab('projects')">Projects</button>
                        <button class="tab-btn" onclick="switchTab('connections')">Connections</button>
                    </div>

                    <!-- About Tab -->
                    <div class="tab-content active" id="about">
                        <div class="section-header">
                            <h2 class="section-title">About</h2>
                            <a href="#" class="edit-btn edit-controls" onclick="editBio()">✏️ Edit</a>
                        </div>
                        <div class="editable-content">
                            <div class="view-mode">
                                <div class="bio-text" id="displayBio">
                                    I'm a researcher focused on the ethical implications of artificial intelligence, particularly in healthcare and education. My work explores how we can ensure AI systems are developed and deployed in ways that prioritize human dignity and social good. I'm passionate about bridging the gap between technical innovation and ethical governance.
                                </div>
                            </div>
                            <div class="edit-mode">
                                <div class="form-group">
                                    <label class="form-label" for="editBioText">About</label>
                                    <textarea id="editBioText" class="textarea">I'm a researcher focused on the ethical implications of artificial intelligence, particularly in healthcare and education. My work explores how we can ensure AI systems are developed and deployed in ways that prioritize human dignity and social good. I'm passionate about bridging the gap between technical innovation and ethical governance.</textarea>
                                </div>
                                <div class="edit-actions">
                                    <button class="btn btn-primary" onclick="saveBio()">💾 Save</button>
                                    <button class="btn btn-secondary" onclick="cancelEditBio()">Cancel</button>
                                </div>
                            </div>
                        </div>

                        <div class="section-header">
                            <h3 class="section-title">Areas of Interest</h3>
                            <a href="#" class="edit-btn edit-controls" onclick="editInterests()">✏️ Edit</a>
                        </div>
                        <div class="editable-content">
                            <div class="view-mode">
                                <div class="tag-list" id="displayInterests">
                                    <span class="tag highlight">AI Ethics & Governance</span>
                                    <span class="tag highlight">Research & Development</span>
                                    <span class="tag highlight">Education & Curriculum</span>
                                    <span class="tag">Policy & Regulation</span>
                                    <span class="tag">Digital Humanitarianism</span>
                                </div>
                            </div>
                            <div class="edit-mode">
                                <div class="form-group">
                                    <label class="form-label" for="editInterestsText">Areas of Interest (comma separated)</label>
                                    <input type="text" id="editInterestsText" class="form-input" value="AI Ethics & Governance, Research & Development, Education & Curriculum, Policy & Regulation, Digital Humanitarianism">
                                </div>
                                <div class="edit-actions">
                                    <button class="btn btn-primary" onclick="saveInterests()">💾 Save</button>
                                    <button class="btn btn-secondary" onclick="cancelEditInterests()">Cancel</button>
                                </div>
                            </div>
                        </div>

                        <div class="section-header">
                            <h3 class="section-title">What I Can Offer</h3>
                            <a href="#" class="edit-btn edit-controls" onclick="editSkills()">✏️ Edit</a>
                        </div>
                        <div class="editable-content">
                            <div class="view-mode">
                                <div class="tag-list" id="displaySkills">
                                    <span class="tag highlight">Academic Research</span>
                                    <span class="tag highlight">Mentoring & Teaching</span>
                                    <span class="tag highlight">Writing & Communication</span>
                                    <span class="tag">Policy Analysis</span>
                                    <span class="tag">Project Management</span>
                                </div>
                            </div>
                            <div class="edit-mode">
                                <div class="form-group">
                                    <label class="form-label" for="editSkillsText">Skills & Offerings (comma separated)</label>
                                    <input type="text" id="editSkillsText" class="form-input" value="Academic Research, Mentoring & Teaching, Writing & Communication, Policy Analysis, Project Management">
                                </div>
                                <div class="edit-actions">
                                    <button class="btn btn-primary" onclick="saveSkills()">💾 Save</button>
                                    <button class="btn btn-secondary" onclick="cancelEditSkills()">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Activity Tab -->
                    <div class="tab-content" id="activity">
                        <div class="section-header">
                            <h2 class="section-title">Recent Activity</h2>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon">📝</div>
                            <div class="activity-content">
                                <div class="activity-title">Published research paper</div>
                                <div class="activity-description">"Ethical Frameworks for AI in Healthcare" - collaborative work with Budapest team</div>
                                <div class="activity-time">2 days ago</div>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon">🤝</div>
                            <div class="activity-content">
                                <div class="activity-title">Joined project</div>
                                <div class="activity-description">AI Ethics Curriculum Development for Catholic Schools</div>
                                <div class="activity-time">1 week ago</div>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon">💬</div>
                            <div class="activity-content">
                                <div class="activity-title">Connected with Dr. Antal Kuthy</div>
                                <div class="activity-description">AI researcher from Budapest University of Technology</div>
                                <div class="activity-time">2 weeks ago</div>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon">🎯</div>
                            <div class="activity-content">
                                <div class="activity-title">Completed project milestone</div>
                                <div class="activity-description">Vatican AI Ethics Guidelines - First draft review</div>
                                <div class="activity-time">3 weeks ago</div>
                            </div>
                        </div>
                    </div>

                    <!-- Projects Tab -->
                    <div class="tab-content" id="projects">
                        <div class="section-header">
                            <h2 class="section-title">My Projects</h2>
                            <a href="dcf_projects_home.html" class="btn btn-primary edit-controls">+ Create Project</a>
                        </div>
                        <div class="project-item" onclick="window.location.href='dcf_projects_home.html'">
                            <div class="project-title">AI Ethics Curriculum for Catholic Schools</div>
                            <div class="project-description">Developing comprehensive curriculum materials for K-12 Catholic schools to teach AI ethics grounded in Catholic Social Teaching.</div>
                            <div class="project-meta">
                                <span>Leading • 12 members</span>
                                <span class="status-badge status-active">Active</span>
                            </div>
                        </div>
                        <div class="project-item" onclick="window.location.href='dcf_projects_home.html'">
                            <div class="project-title">Vatican AI Ethics Guidelines</div>
                            <div class="project-description">Collaborative effort to develop comprehensive AI ethics guidelines for Catholic institutions worldwide.</div>
                            <div class="project-meta">
                                <span>Contributing • 28 members</span>
                                <span class="status-badge status-active">Active</span>
                            </div>
                        </div>
                        <div class="project-item" onclick="window.location.href='dcf_projects_home.html'">
                            <div class="project-title">Digital Humanitarianism Platform</div>
                            <div class="project-description">Building technology solutions for humanitarian organizations to better serve vulnerable populations.</div>
                            <div class="project-meta">
                                <span>Advising • 15 members</span>
                                <span class="status-badge status-pending">Planning</span>
                            </div>
                        </div>
                    </div>

                    <!-- Connections Tab -->
                    <div class="tab-content" id="connections">
                        <div class="section-header">
                            <h2 class="section-title">My Connections</h2>
                            <a href="dcf_members_directory.html" class="btn btn-primary">Find Members</a>
                        </div>
                        <div class="connection-item">
                            <div class="connection-avatar">AK</div>
                            <div class="connection-info">
                                <div class="connection-name">Dr. Antal Kuthy</div>
                                <div class="connection-role">AI Researcher • Budapest University</div>
                            </div>
                        </div>
                        <div class="connection-item">
                            <div class="connection-avatar">ZP</div>
                            <div class="connection-info">
                                <div class="connection-name">Zoltan Papp</div>
                                <div class="connection-role">Tech Entrepreneur • E-Group</div>
                            </div>
                        </div>
                        <div class="connection-item">
                            <div class="connection-avatar">MA</div>
                            <div class="connection-info">
                                <div class="connection-name">Dr. Mary Aiken</div>
                                <div class="connection-role">Cyberpsychologist • Capitol Technology University</div>
                            </div>
                        </div>
                        <div class="connection-item">
                            <div class="connection-avatar">SP</div>
                            <div class="connection-info">
                                <div class="connection-name">Sourabh Pagaria</div>
                                <div class="connection-role">President • Siemens Healthineers</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Check if viewing own profile
        let isOwnProfile = true; // This would be determined by comparing logged-in user with profile being viewed
        let supabase = null;

        // Get Supabase instance 
        async function getSupabaseInstance() {
            if (window.masterSupabase) {
                return window.masterSupabase;
            }
            await new Promise(resolve => setTimeout(resolve, 100));
            return window.masterSupabase || window.supabase.createClient(
                'https://atzommnkkwzgbktuzjti.supabase.co',
                'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF0em9tbW5ra3d6Z2JrdHV6anRpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMzNzAyMzIsImV4cCI6MjA2ODk0NjIzMn0.9mh2A5A5mLbo408S9g7k76VRzSJE0QWdiYTTOPLEiks'
            );
        }

        // Initialize profile editing based on ownership
        document.addEventListener('DOMContentLoaded', async function() {
            supabase = await getSupabaseInstance();
            
            if (isOwnProfile) {
                document.body.classList.add('is-own-profile');
            }

            // Load user profile data
            await loadUserProfile();

            // Check if user is logged in
            const isLoggedIn = localStorage.getItem('dcf_user_logged_in');
            if (isLoggedIn !== 'true') {
                window.location.href = 'dcf_login_page.html';
            }
        });

        // Load user profile from database
        async function loadUserProfile() {
            try {
                const userEmail = localStorage.getItem('dcf_user_email') || 'sarah.johnson@dcfhungary.org';
                
                const { data, error } = await supabase
                    .from('user_profiles')
                    .select('*')
                    .eq('email', userEmail)
                    .single();

                if (error && error.code !== 'PGRST116') {
                    throw error;
                }

                if (data) {
                    populateProfileData(data);
                }
            } catch (error) {
                console.error('Error loading profile:', error);
            }
        }

        // Populate profile with database data
        function populateProfileData(data) {
            // Set profile avatar with fallback to initials
            const profileAvatar = document.getElementById('profileAvatar');
            if (data.avatar_url) {
                profileAvatar.style.backgroundImage = `url(${data.avatar_url})`;
                profileAvatar.style.backgroundSize = 'cover';
                profileAvatar.style.backgroundPosition = 'center';
                profileAvatar.textContent = '';
            } else {
                const initials = generateInitials(data.name || data.first_name + ' ' + data.last_name);
                profileAvatar.textContent = initials;
            }

            // Update name display
            const displayName = document.getElementById('displayName');
            if (displayName) {
                displayName.textContent = data.name || `${data.first_name || ''} ${data.last_name || ''}`.trim();
            }

            // Update title and organization
            const displayTitle = document.getElementById('displayTitle');
            if (displayTitle && data.title && data.organization) {
                displayTitle.textContent = `${data.title} at ${data.organization}`;
            } else if (displayTitle && data.title) {
                displayTitle.textContent = data.title;
            }

            // Update location with country flag
            const displayLocation = document.getElementById('displayLocation');
            if (displayLocation && data.location) {
                displayLocation.textContent = getCountryDisplay(data.location);
            }

            // Update bio
            const displayBio = document.getElementById('displayBio');
            if (displayBio && data.bio) {
                displayBio.textContent = data.bio;
            }

            // Update interests
            if (data.expertise) {
                updateTagDisplay('displayInterests', data.expertise);
            }

            // Update skills
            if (data.skills_offered) {
                updateTagDisplay('displaySkills', data.skills_offered);
            }
        }

        // Helper function to generate initials
        function generateInitials(name) {
            if (!name) return 'SJ';
            const parts = name.trim().split(' ');
            if (parts.length >= 2) {
                return (parts[0][0] + parts[parts.length - 1][0]).toUpperCase();
            }
            return name.substring(0, 2).toUpperCase();
        }

        // Helper function to get country display with flag
        function getCountryDisplay(location) {
            const countryFlags = {
                'United States': '🇺🇸 United States',
                'Hungary': '🇭🇺 Hungary', 
                'Ghana': '🇬🇭 Ghana',
                'United Kingdom': '🇬🇧 United Kingdom',
                'Germany': '🇩🇪 Germany',
                'France': '🇫🇷 France',
                'Canada': '🇨🇦 Canada',
                'Australia': '🇦🇺 Australia',
                'Japan': '🇯🇵 Japan',
                'India': '🇮🇳 India',
                'Brazil': '🇧🇷 Brazil',
                'South Africa': '🇿🇦 South Africa'
            };
            return countryFlags[location] || `📍 ${location}`;
        }

        // Helper function to update tag displays
        function updateTagDisplay(elementId, dataString) {
            const element = document.getElementById(elementId);
            if (!element || !dataString) return;

            const items = dataString.split(',').map(item => item.trim());
            element.innerHTML = '';
            
            items.forEach((item, index) => {
                const tag = document.createElement('span');
                tag.className = index < 3 ? 'tag highlight' : 'tag';
                tag.textContent = item;
                element.appendChild(tag);
            });
        }

        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab button
            event.target.classList.add('active');
        }

        // Basic info editing
        function editBasicInfo() {
            const viewMode = document.querySelector('.profile-info .view-mode');
            const editMode = document.querySelector('.profile-info .edit-mode');
            
            // Populate edit fields with current data
            const currentName = document.getElementById('displayName').textContent;
            const nameParts = currentName.split(' ');
            
            // Handle titles
            const titleSelect = document.getElementById('editTitle');
            const titles = ['Dr.', 'Prof.', 'Mr.', 'Ms.', 'Mrs.', 'Rev.', 'Fr.', 'Sr.', 'Cardinal', 'Bishop', 'Rabbi', 'Imam', 'Pastor'];
            let foundTitle = '';
            let firstName = nameParts[0];
            let lastName = nameParts.slice(1).join(' ');
            
            // Check if first part is a title
            for (let title of titles) {
                if (nameParts[0] === title || nameParts[0] === title.replace('.', '')) {
                    foundTitle = title;
                    firstName = nameParts[1] || '';
                    lastName = nameParts.slice(2).join(' ') || '';
                    break;
                }
            }
            
            titleSelect.value = foundTitle;
            document.getElementById('editFirstName').value = firstName;
            document.getElementById('editLastName').value = lastName;
            document.getElementById('editSubtitle').value = document.getElementById('displayTitle').textContent;
            document.getElementById('editLocation').value = document.getElementById('displayLocation').textContent.replace(/^[🇺🇸🇭🇺🇬🇭🇬🇧🇩🇪🇫🇷🇨🇦🇦🇺🇯🇵🇮🇳🇧🇷🇿🇦📍]\s*/, '');
            
            viewMode.classList.add('editing');
            editMode.classList.add('active');
        }

        async function saveBasicInfo() {
            try {
                const title = document.getElementById('editTitle').value;
                const firstName = document.getElementById('editFirstName').value;
                const lastName = document.getElementById('editLastName').value;
                const subtitle = document.getElementById('editSubtitle').value;
                const location = document.getElementById('editLocation').value;
                
                const fullName = (title ? title + ' ' : '') + firstName + ' ' + lastName;
                
                // Update database
                const userEmail = localStorage.getItem('dcf_user_email');
                const { error } = await supabase
                    .from('user_profiles')
                    .update({
                        name: fullName,
                        first_name: firstName,
                        last_name: lastName,
                        title: subtitle,
                        location: location,
                        updated_at: new Date().toISOString()
                    })
                    .eq('email', userEmail);

                if (error) throw error;

                // Update display
                document.getElementById('displayName').textContent = fullName;
                document.getElementById('displayTitle').textContent = subtitle;
                document.getElementById('displayLocation').textContent = getCountryDisplay(location);
                
                // Update localStorage
                localStorage.setItem('dcf_user_name', fullName);
                
                cancelEditBasicInfo();
                showSuccess('Profile updated successfully!');
            } catch (error) {
                console.error('Error saving profile:', error);
                showSuccess('Error saving profile: ' + error.message);
            }
        }

        function cancelEditBasicInfo() {
            const viewMode = document.querySelector('.profile-info .view-mode');
            const editMode = document.querySelector('.profile-info .edit-mode');
            
            viewMode.classList.remove('editing');
            editMode.classList.remove('active');
        }

        // Bio editing
        function editBio() {
            const section = document.querySelector('#about .editable-content');
            const viewMode = section.querySelector('.view-mode');
            const editMode = section.querySelector('.edit-mode');
            
            viewMode.classList.add('editing');
            editMode.classList.add('active');
        }

        async function saveBio() {
            try {
                const bioText = document.getElementById('editBioText').value;
                
                const userEmail = localStorage.getItem('dcf_user_email');
                const { error } = await supabase
                    .from('user_profiles')
                    .update({
                        bio: bioText,
                        updated_at: new Date().toISOString()
                    })
                    .eq('email', userEmail);

                if (error) throw error;

                document.getElementById('displayBio').textContent = bioText;
                
                cancelEditBio();
                showSuccess('Bio updated successfully!');
            } catch (error) {
                console.error('Error saving bio:', error);
                showSuccess('Error saving bio: ' + error.message);
            }
        }

        function cancelEditBio() {
            const section = document.querySelector('#about .editable-content');
            const viewMode = section.querySelector('.view-mode');
            const editMode = section.querySelector('.edit-mode');
            
            viewMode.classList.remove('editing');
            editMode.classList.remove('active');
        }

        // Interests editing
        function editInterests() {
            const sections = document.querySelectorAll('#about .editable-content');
            const section = sections[1]; // Second editable section is interests
            const viewMode = section.querySelector('.view-mode');
            const editMode = section.querySelector('.edit-mode');
            
            viewMode.classList.add('editing');
            editMode.classList.add('active');
        }

        async function saveInterests() {
            try {
                const interestsText = document.getElementById('editInterestsText').value;
                
                const userEmail = localStorage.getItem('dcf_user_email');
                const { error } = await supabase
                    .from('user_profiles')
                    .update({
                        expertise: interestsText,
                        updated_at: new Date().toISOString()
                    })
                    .eq('email', userEmail);

                if (error) throw error;

                updateTagDisplay('displayInterests', interestsText);
                
                cancelEditInterests();
                showSuccess('Interests updated successfully!');
            } catch (error) {
                console.error('Error saving interests:', error);
                showSuccess('Error saving interests: ' + error.message);
            }
        }

        function cancelEditInterests() {
            const sections = document.querySelectorAll('#about .editable-content');
            const section = sections[1];
            const viewMode = section.querySelector('.view-mode');
            const editMode = section.querySelector('.edit-mode');
            
            viewMode.classList.remove('editing');
            editMode.classList.remove('active');
        }

        // Skills editing
        function editSkills() {
            const sections = document.querySelectorAll('#about .editable-content');
            const section = sections[2]; // Third editable section is skills
            const viewMode = section.querySelector('.view-mode');
            const editMode = section.querySelector('.edit-mode');
            
            viewMode.classList.add('editing');
            editMode.classList.add('active');
        }

        async function saveSkills() {
            try {
                const skillsText = document.getElementById('editSkillsText').value;
                
                const userEmail = localStorage.getItem('dcf_user_email');
                const { error } = await supabase
                    .from('user_profiles')
                    .update({
                        skills_offered: skillsText,
                        updated_at: new Date().toISOString()
                    })
                    .eq('email', userEmail);

                if (error) throw error;

                updateTagDisplay('displaySkills', skillsText);
                
                cancelEditSkills();
                showSuccess('Skills updated successfully!');
            } catch (error) {
                console.error('Error saving skills:', error);
                showSuccess('Error saving skills: ' + error.message);
            }
        }

        function cancelEditSkills() {
            const sections = document.querySelectorAll('#about .editable-content');
            const section = sections[2];
            const viewMode = section.querySelector('.view-mode');
            const editMode = section.querySelector('.edit-mode');
            
            viewMode.classList.remove('editing');
            editMode.classList.remove('active');
        }

        // Utility functions
        function shareProfile() {
            if (navigator.share) {
                navigator.share({
                    title: 'DCF Hungary Profile',
                    text: 'Check out this profile on DCF Hungary',
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(window.location.href);
                showSuccess('Profile URL copied to clipboard!');
            }
        }

        function showSuccess(message) {
            // Create a temporary success message
            const alert = document.createElement('div');
            alert.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #d4edda;
                color: #155724;
                padding: 1rem;
                border-radius: 8px;
                border: 1px solid #c3e6cb;
                z-index: 1000;
            `;
            alert.textContent = message;
            document.body.appendChild(alert);
            
            setTimeout(() => {
                alert.remove();
            }, 3000);
        }

        // Handle avatar upload
        document.getElementById('avatarInput').addEventListener('change', async function(e) {
            const file = e.target.files[0];
            if (file) {
                try {
                    // Generate unique filename
                    const fileExt = file.name.split('.').pop().toLowerCase();
                    const userEmail = localStorage.getItem('dcf_user_email');
                    const timestamp = Date.now();
                    const fileName = `avatar_${userEmail.replace(/[^a-zA-Z0-9]/g, '_')}_${timestamp}.${fileExt}`;
                    
                    // Upload to Supabase Storage
                    const { data, error } = await supabase.storage
                        .from('avatars')
                        .upload(fileName, file, {
                            cacheControl: '3600',
                            upsert: true
                        });
                    
                    if (error) throw error;
                    
                    // Get public URL
                    const { data: urlData } = supabase.storage
                        .from('avatars')
                        .getPublicUrl(fileName);
                    
                    // Update database
                    const { error: updateError } = await supabase
                        .from('user_profiles')
                        .update({ 
                            avatar_url: urlData.publicUrl,
                            updated_at: new Date().toISOString()
                        })
                        .eq('email', userEmail);
                    
                    if (updateError) throw updateError;

                    // Update profile avatar display
                    const profileAvatar = document.getElementById('profileAvatar');
                    profileAvatar.style.backgroundImage = `url(${urlData.publicUrl})`;
                    profileAvatar.style.backgroundSize = 'cover';
                    profileAvatar.style.backgroundPosition = 'center';
                    profileAvatar.textContent = '';
                    
                    showSuccess('Profile picture updated successfully!');
                } catch (error) {
                    console.error('Upload error:', error);
                    showSuccess('Error uploading image: ' + error.message);
                }
            }
        });        
    </script>
</body>
</html>