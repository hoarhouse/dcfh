<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discussion Forums - DCF Hungary</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f8f9fa;
        }

        .header {
            background: white;
            border-bottom: 1px solid #e5e5e5;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .logo {
            display: flex;
            align-items: center;
            font-weight: 600;
            color: #333;
            text-decoration: none;
        }

        .logo-icon {
            width: 24px;
            height: 24px;
            background: #333;
            border-radius: 50%;
            margin-right: 8px;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-menu a {
            text-decoration: none;
            color: #666;
            font-size: 0.9rem;
            position: relative;
        }

        .nav-menu a.active {
            color: #333;
            font-weight: 600;
        }

        .nav-menu a:hover {
            color: #333;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 1rem;
        }



        

        .user-menu {
            position: relative;
        }

        .user-dropdown {
            position: relative;
        }

        .dropdown-menu {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            border: 1px solid #e5e5e5;
            min-width: 280px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .dropdown-menu.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.5rem;
            border-bottom: 1px solid #f0f0f0;
        }

                .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f0f0f0;
            color: #666;
            font-weight: 600;
            font-size: 0.75rem;
            transition: all 0.2s ease;
            box-sizing: border-box;
            overflow: hidden;
            /* Content controlled by master-consolidated.js */
        }

        .user-avatar:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .dropdown-avatar {
            width: 48px;
            height: 48px;
            min-width: 48px;
            min-height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, #000, #333);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1rem;
            flex-shrink: 0;
            box-sizing: border-box;
            overflow: hidden;
        }

        .dropdown-info {
            flex: 1;
            min-width: 0;
        }

        .dropdown-name {
            font-weight: 600;
            color: #333;
            font-size: 1rem;
            margin-bottom: 0.25rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .dropdown-email {
            color: #666;
            font-size: 0.85rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .dropdown-divider {
            height: 1px;
            background: #f0f0f0;
            margin: 0.5rem 0;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.5rem;
            color: #333;
            text-decoration: none;
            transition: all 0.2s ease;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .dropdown-item:hover {
            background: #f8f9fa;
            color: #000;
        }

        .logout-btn {
            color: #dc3545 !important;
            font-weight: 500;
        }

        .logout-btn:hover {
            background: #fee !important;
            color: #c82333 !important;
        }

        .dropdown-icon {
            font-size: 1rem;
            width: 20px;
            text-align: center;
            flex-shrink: 0;
        }

        .dropdown-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 999;
            display: none;
        }

        .dropdown-overlay.active {
            display: block;
        }


        .main-container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        .page-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 1rem;
        }

        .page-subtitle {
            color: #666;
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .content-wrapper {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 2rem;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .sidebar-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .sidebar-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 1rem;
        }

        .new-discussion-card {
            background: linear-gradient(135deg, #000, #333);
            color: white;
            text-align: center;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
        }

        .new-discussion-card h3 {
            margin-bottom: 1rem;
        }

        .new-discussion-card p {
            margin-bottom: 1.5rem;
            opacity: 0.9;
        }

        .new-discussion-card .btn {
            background: white;
            color: #000;
        }

        .new-discussion-card .btn:hover {
            background: #f8f9fa;
        }

        .category-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .category-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: #333;
        }

        .category-item:hover {
            background: #f8f9fa;
        }

        .category-item.active {
            background: #000;
            color: white;
        }

        .category-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .category-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .category-item.active .category-icon {
            background: rgba(255, 255, 255, 0.2);
        }

        .category-details {
            flex: 1;
        }

        .category-name {
            font-weight: 600;
            margin-bottom: 0.2rem;
        }

        .category-description {
            font-size: 0.8rem;
            opacity: 0.7;
        }

        .category-count {
            background: #e5e5e5;
            color: #666;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .category-item.active .category-count {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            text-align: center;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .main-content {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 2rem 2rem 1rem 2rem;
            border-bottom: 1px solid #e5e5e5;
        }

        .search-bar {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .search-input {
            width: 300px;
            padding: 0.75rem;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            font-size: 1rem;
        }

        .search-input:focus {
            outline: none;
            border-color: #333;
        }

        .sort-select {
            padding: 0.75rem;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            font-size: 0.9rem;
            background: white;
            cursor: pointer;
        }

        .sort-select:focus {
            outline: none;
            border-color: #333;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
        }

        .btn-primary {
            background: #000;
            color: white;
        }

        .btn-primary:hover {
            background: #333;
        }

        .btn-secondary {
            background: transparent;
            color: #666;
            border: 2px solid #e5e5e5;
        }

        .btn-secondary:hover {
            color: #333;
            border-color: #333;
        }

        .discussions-list {
            padding: 2rem;
        }

        .discussion-item {
            display: flex;
            gap: 1rem;
            padding: 1.5rem;
            border: 1px solid #e5e5e5;
            border-radius: 12px;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .discussion-item:hover {
            border-color: #333;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .discussion-item.pinned {
            border-color: #ffc107;
            background: #fffbf0;
        }

        .discussion-item.unread {
            border-left: 4px solid #007bff;
        }

        .discussion-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #e5e5e5;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 1rem;
            font-weight: 600;
        }

        .discussion-content {
            flex: 1;
        }

        .discussion-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .discussion-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 0.25rem;
        }

        .discussion-badges {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .badge {
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-pinned {
            background: #fff3cd;
            color: #856404;
        }

        .badge-hot {
            background: #fee;
            color: #c33;
        }

        .badge-solved {
            background: #d4edda;
            color: #155724;
        }

        .discussion-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .discussion-preview {
            color: #666;
            line-height: 1.5;
            margin-bottom: 1rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .discussion-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .tag {
            background: #f8f9fa;
            color: #666;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            border: 1px solid #e5e5e5;
        }

        .discussion-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .discussion-engagement {
            display: flex;
            gap: 1rem;
            font-size: 0.9rem;
            color: #666;
        }

        .engagement-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .discussion-activity {
            color: #666;
            font-size: 0.8rem;
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: #666;
        }

        .empty-state h3 {
            color: #333;
            margin-bottom: 1rem;
        }

        .empty-state p {
            margin-bottom: 2rem;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            padding: 2rem;
        }

        .pagination-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #e5e5e5;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            font-size: 0.9rem;
            color: #666;
            transition: all 0.3s ease;
        }

        .pagination-btn:hover {
            border-color: #333;
            color: #333;
        }

        .pagination-btn.active {
            background: #000;
            color: white;
            border-color: #000;
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #333;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #333;
        }

        .form-select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
            cursor: pointer;
        }

        .form-select:focus {
            outline: none;
            border-color: #333;
        }

        .textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            font-size: 1rem;
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }

        .textarea:focus {
            outline: none;
            border-color: #333;
        }

        .tag-input-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            padding: 0.75rem;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
            min-height: 50px;
            cursor: text;
        }

        .tag-input-container:focus-within {
            border-color: #333;
        }

        .tag-input {
            border: none;
            outline: none;
            flex: 1;
            min-width: 120px;
            font-size: 1rem;
        }

        .tag-item {
            background: #000;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tag-remove {
            cursor: pointer;
            font-weight: bold;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
        }

        .online-members {
            margin-bottom: 1.5rem;
        }

        .online-member {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 0;
        }

        .online-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #e5e5e5;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 0.8rem;
            font-weight: 600;
            position: relative;
        }

        .online-status {
            position: absolute;
            bottom: -2px;
            right: -2px;
            width: 10px;
            height: 10px;
            background: #28a745;
            border-radius: 50%;
            border: 2px solid white;
        }

        .online-name {
            font-size: 0.9rem;
            color: #333;
        }

        @media (max-width: 1024px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }

            .sidebar {
                order: 2;
            }

            .main-content {
                order: 1;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 0 1rem;
            }

            .content-header {
                flex-direction: column;
                gap: 1rem;
            }

            .search-bar {
                flex-direction: column;
                width: 100%;
            }

            .search-input {
                width: 100%;
            }

            .nav-menu {
                display: none;
            }

            .discussion-item {
                flex-direction: column;
                gap: 0.5rem;
            }

            .discussion-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }

            .discussion-stats {
                flex-direction: column;
                gap: 0.5rem;
                align-items: flex-start;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../js/supabase-auth.js"></script>
    <script src="../js/dcf-master-consolidated.js"></script>
</head>

<body>
    <header class="header">
        <nav class="nav-container">
            <a href="../index.html" class="logo">
                <div class="logo-icon"></div>
                Domus Communis Foundation
            </a>
            <ul class="nav-menu" id="navMenu">
            </ul>
            <div class="user-menu">
    <div class="user-dropdown">
        <div class="user-avatar" onclick="toggleUserMenu()" id="userAvatar"></div>        <div class="dropdown-menu" id="userDropdown">
            <div class="dropdown-header">
                <div class="dropdown-avatar"></div>
                <div class="dropdown-info">
                    <div class="dropdown-name" id="dropdownUserName"></div>
                    <div class="dropdown-email" id="dropdownUserEmail"></div>
                </div>
            </div>
            <div class="dropdown-divider"></div>
            
        </div>
    </div>
</div>
        </nav>
    </header>

    <main class="main-container">
        <div class="page-header">
            <h1 class="page-title">Discussion Forums</h1>
            <p class="page-subtitle">
                Engage in meaningful conversations about AI ethics, technology, and humanity's future with the global DCF community
            </p>
        </div>

        <div class="content-wrapper">
            <div class="sidebar">
                <div class="new-discussion-card">
                    <h3>Start a Discussion</h3>
                    <p>Share ideas, ask questions, and collaborate with the community</p>
                    <button class="btn" onclick="openNewDiscussionModal()">💬 New Discussion</button>
                </div>

                <div class="sidebar-card">
                    <h3 class="sidebar-title">Forum Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number">342</div>
                            <div class="stat-label">Discussions</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">1,247</div>
                            <div class="stat-label">Messages</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">189</div>
                            <div class="stat-label">Members</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">23</div>
                            <div class="stat-label">Online</div>
                        </div>
                    </div>
                </div>

                <div class="sidebar-card">
                    <h3 class="sidebar-title">Categories</h3>
                    <div class="category-list">
                        <a href="#" class="category-item active" data-category="all">
                            <div class="category-info">
                                <div class="category-icon">💬</div>
                                <div class="category-details">
                                    <div class="category-name">All Discussions</div>
                                    <div class="category-description">Everything</div>
                                </div>
                            </div>
                            <span class="category-count">342</span>
                        </a>
                        <a href="#" class="category-item" data-category="ai-ethics">
                            <div class="category-info">
                                <div class="category-icon">⚖️</div>
                                <div class="category-details">
                                    <div class="category-name">AI Ethics</div>
                                    <div class="category-description">Ethical AI development</div>
                                </div>
                            </div>
                            <span class="category-count">87</span>
                        </a>
                        <a href="#" class="category-item" data-category="research">
                            <div class="category-info">
                                <div class="category-icon">🔬</div>
                                <div class="category-details">
                                    <div class="category-name">Research</div>
                                    <div class="category-description">Academic discussions</div>
                                </div>
                            </div>
                            <span class="category-count">64</span>
                        </a>
                        <a href="#" class="category-item" data-category="projects">
                            <div class="category-info">
                                <div class="category-icon">🚀</div>
                                <div class="category-details">
                                    <div class="category-name">Project Discussions</div>
                                    <div class="category-description">Collaborate on projects</div>
                                </div>
                            </div>
                            <span class="category-count">92</span>
                        </a>
                        <a href="#" class="category-item" data-category="policy">
                            <div class="category-info">
                                <div class="category-icon">📜</div>
                                <div class="category-details">
                                    <div class="category-name">Policy & Governance</div>
                                    <div class="category-description">AI policy discussions</div>
                                </div>
                            </div>
                            <span class="category-count">45</span>
                        </a>
                        <a href="#" class="category-item" data-category="technology">
                            <div class="category-info">
                                <div class="category-icon">💻</div>
                                <div class="category-details">
                                    <div class="category-name">Technology</div>
                                    <div class="category-description">Technical discussions</div>
                                </div>
                            </div>
                            <span class="category-count">38</span>
                        </a>
                        <a href="#" class="category-item" data-category="community">
                            <div class="category-info">
                                <div class="category-icon">🤝</div>
                                <div class="category-details">
                                    <div class="category-name">Community</div>
                                    <div class="category-description">General community</div>
                                </div>
                            </div>
                            <span class="category-count">16</span>
                        </a>
                    </div>
                </div>

                <div class="sidebar-card">
                    <h3 class="sidebar-title">Online Members</h3>
                    <div class="online-members">
                        <div class="online-member">
                            <div class="online-avatar">
                                AK
                                <div class="online-status"></div>
                            </div>
                            <div class="online-name">Dr. Antal Kuthy</div>
                        </div>
                        <div class="online-member">
                            <div class="online-avatar">
                                MA
                                <div class="online-status"></div>
                            </div>
                            <div class="online-name">Dr. Mary Aiken</div>
                        </div>
                        <div class="online-member">
                            <div class="online-avatar">
                                ZP
                                <div class="online-status"></div>
                            </div>
                            <div class="online-name">Zoltan Papp</div>
                        </div>
                        <div class="online-member">
                            <div class="online-avatar">
                                GS
                                <div class="online-status"></div>
                            </div>
                            <div class="online-name">Greg Sim</div>
                        </div>
                        <div class="online-member">
                            <div class="online-avatar">
                                SP
                                <div class="online-status"></div>
                            </div>
                            <div class="online-name">Sourabh Pagaria</div>
                        </div>
                    </div>
                    <a href="dcf_members_directory.html" style="color: #666; text-decoration: none; font-size: 0.9rem; text-align: center; display: block;">View all online members</a>
                </div>
            </div>

            <div class="main-content">
                <div class="content-header">
                    <div class="search-bar">
                        <input type="text" class="search-input" placeholder="Search discussions..." id="searchInput">
                        <select class="sort-select" id="sortSelect">
                            <option value="recent">Most Recent</option>
                            <option value="popular">Most Popular</option>
                            <option value="answered">Most Answered</option>
                            <option value="unanswered">Unanswered</option>
                            <option value="pinned">Pinned First</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="openNewDiscussionModal()">💬 New Discussion</button>
                </div>

                <div class="discussions-list" id="discussionsList">
                    <div class="discussion-item pinned unread" data-category="ai-ethics">
                        <div class="discussion-avatar">AP</div>
                        <div class="discussion-content">
                            <div class="discussion-header">
                                <div>
                                    <div class="discussion-title">Welcome to DCF Hungary Discussion Forums</div>
                                    <div class="discussion-meta">
                                        <span>by Dr. Alessio Pecorario</span>
                                        <span>•</span>
                                        <span>2 days ago</span>
                                        <span>•</span>
                                        <span>AI Ethics</span>
                                    </div>
                                </div>
                                <div class="discussion-badges">
                                    <span class="badge badge-pinned">Pinned</span>
                                </div>
                            </div>
                            <div class="discussion-preview">
                                Welcome to our community discussion space! Here we can engage in meaningful conversations about AI ethics, share research insights, collaborate on projects, and build the future of human-centered technology together. Please read our community guidelines and introduce yourself...
                            </div>
                            <div class="discussion-tags">
                                <span class="tag">Welcome</span>
                                <span class="tag">Community Guidelines</span>
                                <span class="tag">Introduction</span>
                            </div>
                            <div class="discussion-stats">
                                <div class="discussion-engagement">
                                    <div class="engagement-item">
                                        <span>👍</span>
                                        <span>47</span>
                                    </div>
                                    <div class="engagement-item">
                                        <span>💬</span>
                                        <span>23 replies</span>
                                    </div>
                                    <div class="engagement-item">
                                        <span>👀</span>
                                        <span>156 views</span>
                                    </div>
                                </div>
                                <div class="discussion-activity">
                                    Last reply by Dr. Sarah Johnson • 3 hours ago
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="discussion-item unread" data-category="ai-ethics">
                        <div class="discussion-avatar">SJ</div>
                        <div class="discussion-content">
                            <div class="discussion-header">
                                <div>
                                    <div class="discussion-title">Integrating Catholic Social Teaching into AI Development Frameworks</div>
                                    <div class="discussion-meta">
                                        <span>by Dr. Sarah Johnson</span>
                                        <span>•</span>
                                        <span>4 hours ago</span>
                                        <span>•</span>
                                        <span>AI Ethics</span>
                                    </div>
                                </div>
                                <div class="discussion-badges">
                                    <span class="badge badge-hot">Hot</span>
                                </div>
                            </div>
                            <div class="discussion-preview">
                                I've been working on practical ways to integrate Catholic Social Teaching principles into AI development workflows. The challenge is making these principles actionable for developers who may not be familiar with CST. Has anyone found effective approaches for this?
                            </div>
                            <div class="discussion-tags">
                                <span class="tag">Catholic Social Teaching</span>
                                <span class="tag">AI Development</span>
                                <span class="tag">Ethics Framework</span>
                                <span class="tag">Practical Implementation</span>
                            </div>
                            <div class="discussion-stats">
                                <div class="discussion-engagement">
                                    <div class="engagement-item">
                                        <span>👍</span>
                                        <span>12</span>
                                    </div>
                                    <div class="engagement-item">
                                        <span>💬</span>
                                        <span>8 replies</span>
                                    </div>
                                    <div class="engagement-item">
                                        <span>👀</span>
                                        <span>45 views</span>
                                    </div>
                                </div>
                                <div class="discussion-activity">
                                    Last reply by Fr. Michael Torres • 1 hour ago
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="discussion-item" data-category="research">
                        <div class="discussion-avatar">MA</div>
                        <div class="discussion-content">
                            <div class="discussion-header">
                                <div>
                                    <div class="discussion-title">New Research: Psychological Impact of AI on Children's Development</div>
                                    <div class="discussion-meta">
                                        <span>by Dr. Mary Aiken</span>
                                        <span>•</span>
                                        <span>1 day ago</span>
                                        <span>•</span>
                                        <span>Research</span>
                                    </div>
                                </div>
                            </div>
                            <div class="discussion-preview">
                                Just published findings from our 2-year study on how AI interaction affects child psychological development. The results emphasize the critical need for human-centered AI design in educational contexts. Would love the community's thoughts on the implications...
                            </div>
                            <div class="discussion-tags">
                                <span class="tag">Research</span>
                                <span class="tag">Child Psychology</span>
                                <span class="tag">Education</span>
                                <span class="tag">Human-Centered AI</span>
                            </div>
                            <div class="discussion-stats">
                                <div class="discussion-engagement">
                                    <div class="engagement-item">
                                        <span>👍</span>
                                        <span>18</span>
                                    </div>
                                    <div class="engagement-item">
                                        <span>💬</span>
                                        <span>15 replies</span>
                                    </div>
                                    <div class="engagement-item">
                                        <span>👀</span>
                                        <span>73 views</span>
                                    </div>
                                </div>
                                <div class="discussion-activity">
                                    Last reply by Dr. Sarah Johnson • 6 hours ago
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="discussion-item" data-category="projects">
                        <div class="discussion-avatar">AK</div>
                        <div class="discussion-content">
                            <div class="discussion-header">
                                <div>
                                    <div class="discussion-title">Seeking Collaboration: AI Safety Research Hub Initiative</div>
                                    <div class="discussion-meta">
                                        <span>by Dr. Antal Kuthy</span>
                                        <span>•</span>
                                        <span>2 days ago</span>
                                        <span>•</span>
                                        <span>Project Discussions</span>
                                    </div>
                                </div>
                            </div>
                            <div class="discussion-preview">
                                We're launching a cross-institutional AI safety research hub in Budapest and looking for international collaborators. The focus is on alignment research, risk mitigation, and developing safety benchmarks for emerging AI systems. Who's interested in joining?
                            </div>
                            <div class="discussion-tags">
                                <span class="tag">AI Safety</span>
                                <span class="tag">Research Collaboration</span>
                                <span class="tag">Budapest</span>
                                <span class="tag">International Partnership</span>
                            </div>
                            <div class="discussion-stats">
                                <div class="discussion-engagement">
                                    <div class="engagement-item">
                                        <span>👍</span>
                                        <span>24</span>
                                    </div>
                                    <div class="engagement-item">
                                        <span>💬</span>
                                        <span>19 replies</span>
                                    </div>
                                    <div class="engagement-item">
                                        <span>👀</span>
                                        <span>89 views</span>
                                    </div>
                                </div>
                                <div class="discussion-activity">
                                    Last reply by Dr. John Peterson • 4 hours ago
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="discussion-item" data-category="policy">
                        <div class="discussion-avatar">DM</div>
                        <div class="discussion-content">
                            <div class="discussion-header">
                                <div>
                                    <div class="discussion-title">EU AI Act Implementation: Challenges and Opportunities</div>
                                    <div class="discussion-meta">
                                        <span>by Danielle McLaughlin</span>
                                        <span>•</span>
                                        <span>3 days ago</span>
                                        <span>•</span>
                                        <span>Policy & Governance</span>
                                    </div>
                                </div>
                                <div class="discussion-badges">
                                    <span class="badge badge-solved">Solved</span>
                                </div>
                            </div>
                            <div class="discussion-preview">
                                As the EU AI Act comes into force, organizations are grappling with compliance requirements. From a legal perspective, I see both challenges and opportunities for advancing human-centered AI principles. What are your organizations doing to prepare?
                            </div>
                            <div class="discussion-tags">
                                <span class="tag">EU AI Act</span>
                                <span class="tag">Legal Compliance</span>
                                <span class="tag">Policy Implementation</span>
                                <span class="tag">Regulatory Framework</span>
                            </div>
                            <div class="discussion-stats">
                                <div class="discussion-engagement">
                                    <div class="engagement-item">
                                        <span>👍</span>
                                        <span>16</span>
                                    </div>
                                    <div class="engagement-item">
                                        <span>💬</span>
                                        <span>22 replies</span>
                                    </div>
                                    <div class="engagement-item">
                                        <span>👀</span>
                                        <span>91 views</span>
                                    </div>
                                </div>
                                <div class="discussion-activity">
                                    Last reply by Steve Hill • 1 day ago
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="discussion-item" data-category="technology">
                        <div class="discussion-avatar">ZP</div>
                        <div class="discussion-content">
                            <div class="discussion-header">
                                <div>
                                    <div class="discussion-title">Sovereign AI Systems: Technical Architecture for Data Sovereignty</div>
                                    <div class="discussion-meta">
                                        <span>by Zoltan Papp</span>
                                        <span>•</span>
                                        <span>4 days ago</span>
                                        <span>•</span>
                                        <span>Technology</span>
                                    </div>
                                </div>
                            </div>
                            <div class="discussion-preview">
                                Working on technical specifications for sovereign AI systems that ensure data sovereignty while enabling federated learning. The challenge is balancing privacy, performance, and interoperability. Looking for technical feedback on our approach...
                            </div>
                            <div class="discussion-tags">
                                <span class="tag">Sovereign AI</span>
                                <span class="tag">Data Sovereignty</span>
                                <span class="tag">Federated Learning</span>
                                <span class="tag">Technical Architecture</span>
                            </div>
                            <div class="discussion-stats">
                                <div class="discussion-engagement">
                                    <div class="engagement-item">
                                        <span>👍</span>
                                        <span>9</span>
                                    </div>
                                    <div class="engagement-item">
                                        <span>💬</span>
                                        <span>11 replies</span>
                                    </div>
                                    <div class="engagement-item">
                                        <span>👀</span>
                                        <span>34 views</span>
                                    </div>
                                </div>
                                <div class="discussion-activity">
                                    Last reply by Dr. Antal Kuthy • 2 days ago
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="discussion-item" data-category="community">
                        <div class="discussion-avatar">SP</div>
                        <div class="discussion-content">
                            <div class="discussion-header">
                                <div>
                                    <div class="discussion-title">Healthcare AI Ethics: Lessons from Emerging Markets</div>
                                    <div class="discussion-meta">
                                        <span>by Sourabh Pagaria</span>
                                        <span>•</span>
                                        <span>5 days ago</span>
                                        <span>•</span>
                                        <span>Community</span>
                                    </div>
                                </div>
                            </div>
                            <div class="discussion-preview">
                                Two decades of experience in emerging markets has taught me unique lessons about implementing AI in healthcare contexts where resources are limited but needs are great. I'd love to share insights and hear from others working in similar contexts...
                            </div>
                            <div class="discussion-tags">
                                <span class="tag">Healthcare AI</span>
                                <span class="tag">Emerging Markets</span>
                                <span class="tag">Resource Constraints</span>
                                <span class="tag">Global Health</span>
                            </div>
                            <div class="discussion-stats">
                                <div class="discussion-engagement">
                                    <div class="engagement-item">
                                        <span>👍</span>
                                        <span>14</span>
                                    </div>
                                    <div class="engagement-item">
                                        <span>💬</span>
                                        <span>7 replies</span>
                                    </div>
                                    <div class="engagement-item">
                                        <span>👀</span>
                                        <span>52 views</span>
                                    </div>
                                </div>
                                <div class="discussion-activity">
                                    Last reply by Michael Wilson • 3 days ago
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="discussion-item" data-category="projects">
                        <div class="discussion-avatar">MW</div>
                        <div class="discussion-content">
                            <div class="discussion-header">
                                <div>
                                    <div class="discussion-title">Digital Humanitarianism: Technology Solutions for Vulnerable Populations</div>
                                    <div class="discussion-meta">
                                        <span>by Michael Wilson</span>
                                        <span>•</span>
                                        <span>1 week ago</span>
                                        <span>•</span>
                                        <span>Project Discussions</span>
                                    </div>
                                </div>
                            </div>
                            <div class="discussion-preview">
                                Building on 30 years of infrastructure development in Africa, we're developing a platform for humanitarian organizations that prioritizes data privacy and human dignity. Looking for technologists and ethicists to join our advisory team...
                            </div>
                            <div class="discussion-tags">
                                <span class="tag">Digital Humanitarianism</span>
                                <span class="tag">Africa</span>
                                <span class="tag">Data Privacy</span>
                                <span class="tag">Vulnerable Populations</span>
                            </div>
                            <div class="discussion-stats">
                                <div class="discussion-engagement">
                                    <div class="engagement-item">
                                        <span>👍</span>
                                        <span>21</span>
                                    </div>
                                    <div class="engagement-item">
                                        <span>💬</span>
                                        <span>13 replies</span>
                                    </div>
                                    <div class="engagement-item">
                                        <span>👀</span>
                                        <span>67 views</span>
                                    </div>
                                </div>
                                <div class="discussion-activity">
                                    Last reply by Dr. Sarah Johnson • 5 days ago
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="pagination">
                    <button class="pagination-btn" disabled>← Previous</button>
                    <button class="pagination-btn active">1</button>
                    <button class="pagination-btn">2</button>
                    <button class="pagination-btn">3</button>
                    <button class="pagination-btn">4</button>
                    <button class="pagination-btn">5</button>
                    <button class="pagination-btn">Next →</button>
                </div>
            </div>
        </div>
    </main>

    <!-- New Discussion Modal -->
    <div class="modal" id="newDiscussionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Start a New Discussion</h2>
                <button class="close-btn" onclick="closeNewDiscussionModal()">&times;</button>
            </div>
            <form id="newDiscussionForm">
                <div class="form-group">
                    <label class="form-label" for="discussionTitle">Discussion Title *</label>
                    <input type="text" id="discussionTitle" class="form-input" placeholder="What would you like to discuss?" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="discussionCategory">Category *</label>
                    <select id="discussionCategory" class="form-select" required>
                        <option value="">Select a category</option>
                        <option value="ai-ethics">AI Ethics</option>
                        <option value="research">Research</option>
                        <option value="projects">Project Discussions</option>
                        <option value="policy">Policy & Governance</option>
                        <option value="technology">Technology</option>
                        <option value="community">Community</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="discussionContent">Discussion Content *</label>
                    <textarea id="discussionContent" class="textarea" placeholder="Share your thoughts, questions, or ideas with the community..." required></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Tags</label>
                    <div class="tag-input-container" onclick="document.getElementById('tagInput').focus()">
                        <input type="text" id="tagInput" class="tag-input" placeholder="Add tags to help others find your discussion...">
                    </div>
                    <small style="color: #666; font-size: 0.8rem;">Press Enter to add a tag</small>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeNewDiscussionModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Start Discussion</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let selectedTags = [];

        // Category filtering
        document.querySelectorAll('.category-item').forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Update active category
                document.querySelectorAll('.category-item').forEach(cat => cat.classList.remove('active'));
                this.classList.add('active');
                
                // Filter discussions
                const category = this.dataset.category;
                filterDiscussions(category);
            });
        });

        function filterDiscussions(category) {
            const discussions = document.querySelectorAll('.discussion-item');
            
            discussions.forEach(discussion => {
                if (category === 'all' || discussion.dataset.category === category) {
                    discussion.style.display = 'flex';
                } else {
                    discussion.style.display = 'none';
                }
            });
        }

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();
            const discussions = document.querySelectorAll('.discussion-item');
            
            discussions.forEach(discussion => {
                const title = discussion.querySelector('.discussion-title').textContent.toLowerCase();
                const preview = discussion.querySelector('.discussion-preview').textContent.toLowerCase();
                const author = discussion.querySelector('.discussion-meta').textContent.toLowerCase();
                
                if (title.includes(searchTerm) || preview.includes(searchTerm) || author.includes(searchTerm)) {
                    discussion.style.display = 'flex';
                } else {
                    discussion.style.display = 'none';
                }
            });
        });

        // Sort functionality
        document.getElementById('sortSelect').addEventListener('change', function() {
            const sortBy = this.value;
            const discussionsContainer = document.getElementById('discussionsList');
            const discussions = Array.from(document.querySelectorAll('.discussion-item'));
            
            discussions.sort((a, b) => {
                switch(sortBy) {
                    case 'popular':
                        const likesA = parseInt(a.querySelector('.engagement-item span:nth-child(2)').textContent);
                        const likesB = parseInt(b.querySelector('.engagement-item span:nth-child(2)').textContent);
                        return likesB - likesA;
                    case 'answered':
                        const repliesA = parseInt(a.querySelector('.engagement-item:nth-child(2) span:nth-child(2)').textContent);
                        const repliesB = parseInt(b.querySelector('.engagement-item:nth-child(2) span:nth-child(2)').textContent);
                        return repliesB - repliesA;
                    case 'unanswered':
                        const repliesA2 = parseInt(a.querySelector('.engagement-item:nth-child(2) span:nth-child(2)').textContent);
                        const repliesB2 = parseInt(b.querySelector('.engagement-item:nth-child(2) span:nth-child(2)').textContent);
                        return repliesA2 - repliesB2;
                    case 'pinned':
                        const pinnedA = a.classList.contains('pinned') ? 1 : 0;
                        const pinnedB = b.classList.contains('pinned') ? 1 : 0;
                        return pinnedB - pinnedA;
                    default: // recent
                        return 0; // Already in chronological order
                }
            });
            
            discussions.forEach(discussion => {
                discussionsContainer.appendChild(discussion);
            });
        });

        // Modal functions
        function openNewDiscussionModal() {
            document.getElementById('newDiscussionModal').classList.add('active');
        }

        function closeNewDiscussionModal() {
            document.getElementById('newDiscussionModal').classList.remove('active');
            document.getElementById('newDiscussionForm').reset();
            selectedTags = [];
            updateTagDisplay();
        }

        // Tag input functionality
        document.getElementById('tagInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                const tag = this.value.trim();
                if (tag && !selectedTags.includes(tag)) {
                    selectedTags.push(tag);
                    this.value = '';
                    updateTagDisplay();
                }
            }
        });

        function updateTagDisplay() {
            const container = document.querySelector('.tag-input-container');
            const input = document.getElementById('tagInput');
            
            // Remove existing tag elements
            container.querySelectorAll('.tag-item').forEach(tag => tag.remove());
            
            // Add tag elements
            selectedTags.forEach(tag => {
                const tagElement = document.createElement('div');
                tagElement.className = 'tag-item';
                tagElement.innerHTML = `
                    ${tag}
                    <span class="tag-remove" onclick="removeTag('${tag}')">&times;</span>
                `;
                container.insertBefore(tagElement, input);
            });
        }

        function removeTag(tag) {
            selectedTags = selectedTags.filter(t => t !== tag);
            updateTagDisplay();
        }

        // Form submission
        document.getElementById('newDiscussionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = {
                title: document.getElementById('discussionTitle').value,
                category: document.getElementById('discussionCategory').value,
                content: document.getElementById('discussionContent').value,
                tags: selectedTags
            };
            
            // Simulate creating discussion
            console.log('New discussion:', formData);
            showAlert('Discussion created successfully!', 'success', 'Discussion Created');
            closeNewDiscussionModal();
        });

        // Discussion item click to view full discussion
        document.querySelectorAll('.discussion-item').forEach(item => {
            item.addEventListener('click', function() {
                // In a real app, this would navigate to the full discussion thread
                showAlert('Full discussion view would be implemented here.', 'info', 'View Discussion');
            });
        });

        // Pagination
        document.querySelectorAll('.pagination-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                if (this.disabled) return;
                
                document.querySelectorAll('.pagination-btn').forEach(b => b.classList.remove('active'));
                
                if (!this.textContent.includes('Previous') && !this.textContent.includes('Next')) {
                    this.classList.add('active');
                }
            });
        });

        // Close modal when clicking outside
        document.getElementById('newDiscussionModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeNewDiscussionModal();
            }
        });

        // Online member clicks
        document.querySelectorAll('.online-member').forEach(member => {
            member.addEventListener('click', function() {
                // In a real app, this would open member profile or start a chat
                showAlert('Member profile or chat would open here.', 'info', 'Member Profile');
            });
   });

        // User menu functionality
        let isDropdownOpen = false;

        function toggleUserMenu() {
            const dropdown = document.getElementById('userDropdown');
            const overlay = getOrCreateOverlay();
            
            if (isDropdownOpen) {
                closeUserMenu();
            } else {
                openUserMenu();
            }
        }

        function openUserMenu() {
            const dropdown = document.getElementById('userDropdown');
            const overlay = getOrCreateOverlay();
            
            dropdown.classList.add('active');
            overlay.classList.add('active');
            isDropdownOpen = true;
            
            // updateUserDropdownInfo(); - removed, handled by master JS
        }

        function closeUserMenu() {
            const dropdown = document.getElementById('userDropdown');
            const overlay = document.querySelector('.dropdown-overlay');
            
            dropdown.classList.remove('active');
            if (overlay) overlay.classList.remove('active');
            isDropdownOpen = false;
        }

        function getOrCreateOverlay() {
            let overlay = document.querySelector('.dropdown-overlay');
            if (!overlay) {
                overlay = document.createElement('div');
                overlay.className = 'dropdown-overlay';
                overlay.onclick = closeUserMenu;
                document.body.appendChild(overlay);
            }
            return overlay;
        }

        // updateUserDropdownInfo function removed - handled by master JS

        function generateInitials(name) {
            if (!name) return 'SJ';
            const parts = name.split(' ');
            if (parts.length >= 2) {
                return (parts[0][0] + parts[parts.length - 1][0]).toUpperCase();
            }
            return name.substring(0, 2).toUpperCase();
        }

        // Logout function removed - now using global handleLogout() from dcf-master-consolidated.js

        // Initialize user menu on page load
        document.addEventListener('DOMContentLoaded', function() {
            // updateUserDropdownInfo(); - removed, handled by master JS

            // Check if user is logged in
            const isLoggedIn = localStorage.getItem('dcf_user_logged_in');
            if (isLoggedIn !== 'true') {
                // DISABLED: alert('Please log in to access member pages.');
                window.location.href = '../auth/dcf_login_page.html';
            }

            // Close dropdown on escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && isDropdownOpen) {
                    closeUserMenu();
                }
            });
        });
    </script>
</body>
</html>